<?xml version="1.0"?>
<AlteryxDocument yxmdVer="11.3">
  <Nodes>
    <Node ToolID="1">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="54" y="54" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>49DAF891AB1B58B7702EF676B9DCAA37A04C46A4D</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */
/* Pulls pre- and post- period spend and number of visits */

    WITH SR AS (
          SELECT S1.GUID_USER_ID,
          --FIRST SURVEY
          S1.STORE_NUM AS STORE_NUM_1,
          S1.CASE_ID AS CASE_ID_1,
          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,
          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,
          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,
          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,
          --SECOND SURVEY
          S2.STORE_NUM AS STORE_NUM_2,
          S2.CASE_ID AS CASE_ID_2,
          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,
          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,
          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,
          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2
          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1
          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2
          ON S1.GUID_USER_ID = S2.GUID_USER_ID
          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60
          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0
          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'
          --AND S1.CASE_ID = '02201504240950280001544808'
         INNER JOIN APPCA.D_STORE_VERS v1
         ON v1.STORE_NUM = S1.STORE_NUM
         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'
         INNER JOIN APPCA.D_STORE_VERS v2
         ON v2.STORE_NUM = S2.STORE_NUM
         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'
          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'
          AND S2.TRANS_DTM &gt;='01-AUG-2017'
          GROUP BY S1.GUID_USER_ID,
          --FIRST SURVEY
          S1.STORE_NUM,
          S1.CASE_ID,
          TRUNC(S1.TRANS_DTM),
          TO_CHAR(S1.TRANS_DTM, 'HH24'),
          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),
          --SECOND SURVEY
          S2.STORE_NUM,
          S2.CASE_ID,
          TRUNC(S2.TRANS_DTM),
          TO_CHAR(S2.TRANS_DTM, 'HH24'),
          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))
    ),

SR2 AS (
    SELECT SR.GUID_USER_ID,
      SR.STORE_NUM_1,
      SR.CASE_ID_1,
      SR.TRANS_DTM_1,
      SR.TRANS_HR_1,
      SR.TRANS_ID_1,
      SR.WORTH_1,
      SR.CC_1,
      SR.SPEED_1,
      SR.ACCR_1,
      SR.BEV_1,
      SR.FOOD_1,
      SR.CLEAN_1,
      SR.ABVBYD_1,
      SR.RETURN_1,
      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,
      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,
      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,
      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,
      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,
      SR.STORE_NUM_2,
      SR.CASE_ID_2,
      SR.TRANS_DTM_2,
      SR.TRANS_HR_2,
      SR.TRANS_ID_2,
      SR.WORTH_2,
      SR.CC_2,
      SR.SPEED_2,
      SR.ACCR_2,
      SR.BEV_2,
      SR.FOOD_2,
      SR.CLEAN_2,
      SR.ABVBYD_2,
      SR.RETURN_2
    FROM SR
      LEFT OUTER JOIN APPCA.F_POS_HDR POS1
      ON SR.GUID_USER_ID = POS1.GUID_ID
      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY 
      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY 
      GROUP BY SR.GUID_USER_ID,
      SR.STORE_NUM_1,
      SR.CASE_ID_1,
      SR.TRANS_DTM_1,
      SR.TRANS_HR_1,
      SR.TRANS_ID_1,
      SR.WORTH_1,
      SR.CC_1,
      SR.SPEED_1,
      SR.ACCR_1,
      SR.BEV_1,
      SR.FOOD_1,
      SR.CLEAN_1,
      SR.ABVBYD_1,
      SR.RETURN_1,
      SR.STORE_NUM_2,
      SR.CASE_ID_2,
      SR.TRANS_DTM_2,
      SR.TRANS_HR_2,
      SR.TRANS_ID_2,
      SR.WORTH_2,
      SR.CC_2,
      SR.SPEED_2,
      SR.ACCR_2,
      SR.BEV_2,
      SR.FOOD_2,
      SR.CLEAN_2,
      SR.ABVBYD_2,
      SR.RETURN_2
)
SELECT 
      SR2.*,
  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,
  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,
  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,
  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2
  FROM SR2
  LEFT OUTER JOIN APPCA.F_POS_HDR POS2
  ON SR2.GUID_USER_ID = POS2.GUID_ID
  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY 
  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY 
  GROUP BY 
  SR2.GUID_USER_ID,
      SR2.STORE_NUM_1,
      SR2.CASE_ID_1,
      SR2.TRANS_DTM_1,
      SR2.TRANS_HR_1,
      SR2.TRANS_ID_1,
      SR2.WORTH_1,
      SR2.CC_1,
      SR2.SPEED_1,
      SR2.ACCR_1,
      SR2.BEV_1,
      SR2.FOOD_1,
      SR2.CLEAN_1,
      SR2.ABVBYD_1,
      SR2.RETURN_1,
      SR2.SPEND_PRE_15D_1,
      SR2.SPEND_POST_15D_1,
      SR2.ROWS_SPEND_POST_15D_1,
      SR2.VISITS_PRE_15D_1,
      SR2.VISITS_POST_15D_1,
      SR2.STORE_NUM_2,
      SR2.CASE_ID_2,
      SR2.TRANS_DTM_2,
      SR2.TRANS_HR_2,
      SR2.TRANS_ID_2,
      SR2.WORTH_2,
      SR2.CC_2,
      SR2.SPEED_2,
      SR2.ACCR_2,
      SR2.BEV_2,
      SR2.FOOD_2,
      SR2.CLEAN_2,
      SR2.ABVBYD_2,
      SR2.RETURN_2</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=/* Same customer pre- and post- survey behavior */
/* Pulls pre- and post- period spend and number of visits */

    WITH SR AS (
          SELECT S1.GUID_USER_ID,
          --FIRST SURVEY
          S1.STORE_NUM AS STORE_NUM_1,
          S1.CASE_ID AS CASE_ID_1,
          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,
          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,
          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,
          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,
          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,
          --SECOND SURVEY
          S2.STORE_NUM AS STORE_NUM_2,
          S2.CASE_ID AS CASE_ID_2,
          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,
          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,
          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,
          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,
          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2
          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1
          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2
          ON S1.GUID_USER_ID = S2.GUID_USER_ID
          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60
          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0
          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'
          --AND S1.CASE_ID = '02201504240950280001544808'
         INNER JOIN APPCA.D_STORE_VERS v1
         ON v1.STORE_NUM = S1.STORE_NUM
         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'
         INNER JOIN APPCA.D_STORE_VERS v2
         ON v2.STORE_NUM = S2.STORE_NUM
         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'
          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'
          AND S2.TRANS_DTM &gt;='01-AUG-2017'
          GROUP BY S1.GUID_USER_ID,
          --FIRST SURVEY
          S1.STORE_NUM,
          S1.CASE_ID,
          TRUNC(S1.TRANS_DTM),
          TO_CHAR(S1.TRANS_DTM, 'HH24'),
          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),
          --SECOND SURVEY
          S2.STORE_NUM,
          S2.CASE_ID,
          TRUNC(S2.TRANS_DTM),
          TO_CHAR(S2.TRANS_DTM, 'HH24'),
          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))
    ),

SR2 AS (
    SELECT SR.GUID_USER_ID,
      SR.STORE_NUM_1,
      SR.CASE_ID_1,
      SR.TRANS_DTM_1,
      SR.TRANS_HR_1,
      SR.TRANS_ID_1,
      SR.WORTH_1,
      SR.CC_1,
      SR.SPEED_1,
      SR.ACCR_1,
      SR.BEV_1,
      SR.FOOD_1,
      SR.CLEAN_1,
      SR.ABVBYD_1,
      SR.RETURN_1,
      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,
      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,
      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,
      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,
      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,
      SR.STORE_NUM_2,
      SR.CASE_ID_2,
      SR.TRANS_DTM_2,
      SR.TRANS_HR_2,
      SR.TRANS_ID_2,
      SR.WORTH_2,
      SR.CC_2,
      SR.SPEED_2,
      SR.ACCR_2,
      SR.BEV_2,
      SR.FOOD_2,
      SR.CLEAN_2,
      SR.ABVBYD_2,
      SR.RETURN_2
    FROM SR
      LEFT OUTER JOIN APPCA.F_POS_HDR POS1
      ON SR.GUID_USER_ID = POS1.GUID_ID
      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY 
      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY 
      GROUP BY SR.GUID_USER_ID,
      SR.STORE_NUM_1,
      SR.CASE_ID_1,
      SR.TRANS_DTM_1,
      SR.TRANS_HR_1,
      SR.TRANS_ID_1,
      SR.WORTH_1,
      SR.CC_1,
      SR.SPEED_1,
      SR.ACCR_1,
      SR.BEV_1,
      SR.FOOD_1,
      SR.CLEAN_1,
      SR.ABVBYD_1,
      SR.RETURN_1,
      SR.STORE_NUM_2,
      SR.CASE_ID_2,
      SR.TRANS_DTM_2,
      SR.TRANS_HR_2,
      SR.TRANS_ID_2,
      SR.WORTH_2,
      SR.CC_2,
      SR.SPEED_2,
      SR.ACCR_2,
      SR.BEV_2,
      SR.FOOD_2,
      SR.CLEAN_2,
      SR.ABVBYD_2,
      SR.RETURN_2
)
SELECT 
      SR2.*,
  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,
  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,
  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,
  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2
  FROM SR2
  LEFT OUTER JOIN APPCA.F_POS_HDR POS2
  ON SR2.GUID_USER_ID = POS2.GUID_ID
  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY 
  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY 
  GROUP BY 
  SR2.GUID_USER_ID,
      SR2.STORE_NUM_1,
      SR2.CASE_ID_1,
      SR2.TRANS_DTM_1,
      SR2.TRANS_HR_1,
      SR2.TRANS_ID_1,
      SR2.WORTH_1,
      SR2.CC_1,
      SR2.SPEED_1,
      SR2.ACCR_1,
      SR2.BEV_1,
      SR2.FOOD_1,
      SR2.CLEAN_1,
      SR2.ABVBYD_1,
      SR2.RETURN_1,
      SR2.SPEND_PRE_15D_1,
      SR2.SPEND_POST_15D_1,
      SR2.ROWS_SPEND_POST_15D_1,
      SR2.VISITS_PRE_15D_1,
      SR2.VISITS_POST_15D_1,
      SR2.STORE_NUM_2,
      SR2.CASE_ID_2,
      SR2.TRANS_DTM_2,
      SR2.TRANS_HR_2,
      SR2.TRANS_ID_2,
      SR2.WORTH_2,
      SR2.CC_2,
      SR2.SPEED_2,
      SR2.ACCR_2,
      SR2.BEV_2,
      SR2.FOOD_2,
      SR2.CLEAN_2,
      SR2.ABVBYD_2,
      SR2.RETURN_2</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="GUID_USER_ID" size="51" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="V_WString" />
            <Field name="STORE_NUM_1" size="11" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="WString" />
            <Field name="CASE_ID_1" size="51" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="V_WString" />
            <Field name="TRANS_DTM_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="DateTime" />
            <Field name="TRANS_HR_1" size="3" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="WString" />
            <Field name="TRANS_ID_1" size="69" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="V_WString" />
            <Field name="WORTH_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="CC_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="SPEED_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="ACCR_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="BEV_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="FOOD_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="CLEAN_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="ABVBYD_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="RETURN_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="SPEND_PRE_15D_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="SPEND_POST_15D_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="ROWS_SPEND_POST_15D_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="VISITS_PRE_15D_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="VISITS_POST_15D_1" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="STORE_NUM_2" size="11" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="WString" />
            <Field name="CASE_ID_2" size="51" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="V_WString" />
            <Field name="TRANS_DTM_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="DateTime" />
            <Field name="TRANS_HR_2" size="3" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="WString" />
            <Field name="TRANS_ID_2" size="69" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="V_WString" />
            <Field name="WORTH_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="CC_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="SPEED_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="ACCR_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="BEV_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="FOOD_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="CLEAN_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="ABVBYD_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="RETURN_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="SPEND_PRE_15D_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="SPEND_POST_15D_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="VISITS_PRE_15D_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
            <Field name="VISITS_POST_15D_2" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* Same customer pre- and post- survey behavior */&#xA;/* Pulls pre- and post- period spend and number of visits */&#xA;&#xA;    WITH SR AS (&#xA;          SELECT S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM AS STORE_NUM_1,&#xA;          S1.CASE_ID AS CASE_ID_1,&#xA;          TRUNC(S1.TRANS_DTM) AS TRANS_DTM_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24') AS TRANS_HR_1,&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)) AS TRANS_ID_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS WORTH_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_2' THEN S1.RSPNS_ID END) AS CC_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_1' THEN S1.RSPNS_ID END) AS SPEED_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_4' THEN S1.RSPNS_ID END) AS ACCR_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_5' THEN S1.RSPNS_ID END) AS BEV_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_6' THEN S1.RSPNS_ID END) AS FOOD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_7' THEN S1.RSPNS_ID END) AS CLEAN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_3' THEN S1.RSPNS_ID END) AS ABVBYD_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q1' THEN S1.RSPNS_ID END) AS RETURN_1,&#xA;          AVG(CASE WHEN S1.QSTN_ID='Q2_8' THEN S1.RSPNS_ID END) AS N_ROWS_WORTH_1,&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM AS STORE_NUM_2,&#xA;          S2.CASE_ID AS CASE_ID_2,&#xA;          TRUNC(S2.TRANS_DTM) AS TRANS_DTM_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24') AS TRANS_HR_2,&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID)) AS TRANS_ID_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS WORTH_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_2' THEN S2.RSPNS_ID END) AS CC_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_1' THEN S2.RSPNS_ID END) AS SPEED_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_4' THEN S2.RSPNS_ID END) AS ACCR_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_5' THEN S2.RSPNS_ID END) AS BEV_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_6' THEN S2.RSPNS_ID END) AS FOOD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_7' THEN S2.RSPNS_ID END) AS CLEAN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_3' THEN S2.RSPNS_ID END) AS ABVBYD_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q1'   THEN S2.RSPNS_ID END) AS RETURN_2,&#xA;          AVG(CASE WHEN S2.QSTN_ID='Q2_8' THEN S2.RSPNS_ID END) AS N_ROWS_WORTH_2&#xA;          FROM APPOTHER.AFT_CV_SRVY_RSPNS S1&#xA;          INNER JOIN APPOTHER.AFT_CV_SRVY_RSPNS S2&#xA;          ON S1.GUID_USER_ID = S2.GUID_USER_ID&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &gt;60&#xA;          AND TRUNC(S1.TRANS_DTM)-TRUNC(S2.TRANS_DTM) &lt;0&#xA;          --AND S1.GUID_USER_ID = '4CC6549F-047A-41BF-984D-2CFD8C40C330'&#xA;          --AND S1.CASE_ID = '02201504240950280001544808'&#xA;         INNER JOIN APPCA.D_STORE_VERS v1&#xA;         ON v1.STORE_NUM = S1.STORE_NUM&#xA;         AND v1.CURRENT_FLG = 'Y' AND v1.CNTRY_CD_2_DGT_ISO = 'US' AND v1.OWNR_TYPE_CD = 'CO'&#xA;         INNER JOIN APPCA.D_STORE_VERS v2&#xA;         ON v2.STORE_NUM = S2.STORE_NUM&#xA;         AND v2.CURRENT_FLG = 'Y' AND v2.CNTRY_CD_2_DGT_ISO = 'US' AND v2.OWNR_TYPE_CD = 'CO'&#xA;          WHERE S1.TRANS_DTM &gt;='01-AUG-2017'&#xA;          AND S2.TRANS_DTM &gt;='01-AUG-2017'&#xA;          GROUP BY S1.GUID_USER_ID,&#xA;          --FIRST SURVEY&#xA;          S1.STORE_NUM,&#xA;          S1.CASE_ID,&#xA;          TRUNC(S1.TRANS_DTM),&#xA;          TO_CHAR(S1.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S1.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S1.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S1.RGSTR_NUM, '00')) || TRIM(to_char(S1.TRANS_ID)),&#xA;          --SECOND SURVEY&#xA;          S2.STORE_NUM,&#xA;          S2.CASE_ID,&#xA;          TRUNC(S2.TRANS_DTM),&#xA;          TO_CHAR(S2.TRANS_DTM, 'HH24'),&#xA;          TO_CHAR(S2.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S2.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S2.RGSTR_NUM, '00')) || TRIM(to_char(S2.TRANS_ID))&#xA;    ),&#xA;&#xA;SR2 AS (&#xA;    SELECT SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_1,&#xA;      SUM(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_1,&#xA;      COUNT(CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.GROSS_REV_LCL_AMT ELSE NULL END) AS ROWS_SPEND_POST_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &lt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_1,&#xA;      COUNT(DISTINCT CASE WHEN POS1.BUS_DT &gt; TRUNC(SR.TRANS_DTM_1) THEN POS1.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;    FROM SR&#xA;      LEFT OUTER JOIN APPCA.F_POS_HDR POS1&#xA;      ON SR.GUID_USER_ID = POS1.GUID_ID&#xA;      AND POS1.BUS_DT &gt;= TRUNC(SR.TRANS_DTM_1)- INTERVAL'15'DAY &#xA;      AND POS1.BUS_DT &lt;= TRUNC(SR.TRANS_DTM_1)+ INTERVAL'15'DAY &#xA;      GROUP BY SR.GUID_USER_ID,&#xA;      SR.STORE_NUM_1,&#xA;      SR.CASE_ID_1,&#xA;      SR.TRANS_DTM_1,&#xA;      SR.TRANS_HR_1,&#xA;      SR.TRANS_ID_1,&#xA;      SR.WORTH_1,&#xA;      SR.CC_1,&#xA;      SR.SPEED_1,&#xA;      SR.ACCR_1,&#xA;      SR.BEV_1,&#xA;      SR.FOOD_1,&#xA;      SR.CLEAN_1,&#xA;      SR.ABVBYD_1,&#xA;      SR.RETURN_1,&#xA;      SR.STORE_NUM_2,&#xA;      SR.CASE_ID_2,&#xA;      SR.TRANS_DTM_2,&#xA;      SR.TRANS_HR_2,&#xA;      SR.TRANS_ID_2,&#xA;      SR.WORTH_2,&#xA;      SR.CC_2,&#xA;      SR.SPEED_2,&#xA;      SR.ACCR_2,&#xA;      SR.BEV_2,&#xA;      SR.FOOD_2,&#xA;      SR.CLEAN_2,&#xA;      SR.ABVBYD_2,&#xA;      SR.RETURN_2&#xA;)&#xA;SELECT &#xA;      SR2.*,&#xA;  SUM(CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_PRE_15D_2,&#xA;  SUM(CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.GROSS_REV_LCL_AMT ELSE NULL END) AS SPEND_POST_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &lt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_PRE_15D_2,&#xA;  COUNT(DISTINCT CASE WHEN POS2.BUS_DT &gt; TRUNC(SR2.TRANS_DTM_2) THEN POS2.TRANS_ID ELSE NULL END) AS VISITS_POST_15D_2&#xA;  FROM SR2&#xA;  LEFT OUTER JOIN APPCA.F_POS_HDR POS2&#xA;  ON SR2.GUID_USER_ID = POS2.GUID_ID&#xA;  AND POS2.BUS_DT &gt;= TRUNC(SR2.TRANS_DTM_2)- INTERVAL'15'DAY &#xA;  AND POS2.BUS_DT &lt;= TRUNC(SR2.TRANS_DTM_2)+ INTERVAL'15'DAY &#xA;  GROUP BY &#xA;  SR2.GUID_USER_ID,&#xA;      SR2.STORE_NUM_1,&#xA;      SR2.CASE_ID_1,&#xA;      SR2.TRANS_DTM_1,&#xA;      SR2.TRANS_HR_1,&#xA;      SR2.TRANS_ID_1,&#xA;      SR2.WORTH_1,&#xA;      SR2.CC_1,&#xA;      SR2.SPEED_1,&#xA;      SR2.ACCR_1,&#xA;      SR2.BEV_1,&#xA;      SR2.FOOD_1,&#xA;      SR2.CLEAN_1,&#xA;      SR2.ABVBYD_1,&#xA;      SR2.RETURN_1,&#xA;      SR2.SPEND_PRE_15D_1,&#xA;      SR2.SPEND_POST_15D_1,&#xA;      SR2.ROWS_SPEND_POST_15D_1,&#xA;      SR2.VISITS_PRE_15D_1,&#xA;      SR2.VISITS_POST_15D_1,&#xA;      SR2.STORE_NUM_2,&#xA;      SR2.CASE_ID_2,&#xA;      SR2.TRANS_DTM_2,&#xA;      SR2.TRANS_HR_2,&#xA;      SR2.TRANS_ID_2,&#xA;      SR2.WORTH_2,&#xA;      SR2.CC_2,&#xA;      SR2.SPEED_2,&#xA;      SR2.ACCR_2,&#xA;      SR2.BEV_2,&#xA;      SR2.FOOD_2,&#xA;      SR2.CLEAN_2,&#xA;      SR2.ABVBYD_2,&#xA;      SR2.RETURN_2" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="2">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="234" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_13936_637a6457acaa499c9643dd1fcc628876_\Engine_12736_9c411072747348b4908011a1bf2fcde1_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
  </Nodes>
  <Connections>
    <Connection>
      <Origin ToolID="1" Connection="Output" />
      <Destination ToolID="2" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>SameCust_02_pre-post-surveypairs</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
    </MetaInfo>
    <Events>
      <Enabled value="True" />
    </Events>
  </Properties>
</AlteryxDocument>