<?xml version="1.0"?>
<AlteryxDocument yxmdVer="11.3">
  <Nodes>
    <Node ToolID="1">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="54" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */
--/* % home store customers */

SELECT
   T3.STORE_NUM
  ,T3.FSCL_YR_NUM
  ,T3.FSCL_PER_IN_YR_NUM
  ,T3.FSCL_PER_CNT_NUM
  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 
       ELSE NULL 
   END) AS HS_CUST_COUNT
  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT
FROM(
    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD
    SELECT
       STR.STORE_NUM
      ,ca.FSCL_YR_NUM
      ,ca.FSCL_PER_IN_YR_NUM
      ,ca.FSCL_PER_CNT_NUM
      ,POSH2.GUID_ID
    FROM APPCA.F_POS_HDR POSH2
    LEFT OUTER JOIN APPCA.D_STORE_VERS STR
      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY
    INNER JOIN APPCA.D_CAL ca
      ON POSH2.BUS_DT = ca.CAL_DT
    WHERE STR.OWNR_TYPE_CD = 'CO'
      AND STR.CNTRY_CD_2_DGT_ISO = 'US'
      AND POSH2.GROSS_REV_LCL_AMT &gt; 0
       AND ca.FSCL_YR_NUM = 2018 
       AND ca.FSCL_PER_IN_YR_NUM = 4
    
    GROUP BY
       STR.STORE_NUM
      ,ca.FSCL_YR_NUM
      ,ca.FSCL_PER_IN_YR_NUM
      ,ca.FSCL_PER_CNT_NUM
      ,POSH2.GUID_ID
    ) T3
  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES
  INNER JOIN (
    SELECT
       T1.GUID_ID
      ,T1.FSCL_YR_NUM
      ,T1.FSCL_PER_IN_YR_NUM
      ,T1.FSCL_PER_CNT_NUM
      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 
         THEN T1.STORE_NUM 
         ELSE NULL 
       END) AS HOME_STORE
      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 
         THEN T1.N_TRANS 
         ELSE NULL 
       END) AS HOME_STORE_VISITS
      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 
         THEN T1.TOT_SPEND 
         ELSE NULL 
       END) AS HOME_STORE_SPEND
      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS
      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND
    FROM(
      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES
      SELECT
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ,ca.FSCL_PER_CNT_NUM
        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS
        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND
        --this ranks each store that the guid has visited by the number of transactions and spend
        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM 
                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), 
                           -SUM(POSH.GROSS_REV_LCL_AMT)
                  ) 
         AS RNK_HS
      FROM APPCA.F_POS_HDR POSH
      LEFT OUTER JOIN APPCA.D_STORE_VERS STR
        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY
      INNER JOIN APPCA.D_CAL ca
        ON POSH.BUS_DT = ca.CAL_DT
      WHERE STR.OWNR_TYPE_CD = 'CO'
        AND STR.CNTRY_CD_2_DGT_ISO = 'US'
        AND POSH.GROSS_REV_LCL_AMT &gt; 0
       AND ca.FSCL_YR_NUM = 2018 
       AND ca.FSCL_PER_IN_YR_NUM = 4
        
      GROUP BY
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ,ca.FSCL_PER_CNT_NUM
    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC
    GROUP BY
       T1.GUID_ID
      ,T1.FSCL_YR_NUM
      ,T1.FSCL_PER_IN_YR_NUM
      ,T1.FSCL_PER_CNT_NUM
  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS
ON T2.GUID_ID = T3.GUID_ID
  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM

WHERE T2.GUID_ID IS NOT NULL 
  AND T3.GUID_ID IS NOT NULL 
  AND T2.GUID_ID !='0' 
  AND T3.GUID_ID !='0' 

GROUP BY
   T3.STORE_NUM
  ,T3.FSCL_YR_NUM
  ,T3.FSCL_PER_IN_YR_NUM
  ,T3.FSCL_PER_CNT_NUM</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=--/* CAW */
--/* % home store customers */

SELECT
   T3.STORE_NUM
  ,T3.FSCL_YR_NUM
  ,T3.FSCL_PER_IN_YR_NUM
  ,T3.FSCL_PER_CNT_NUM
  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 
       ELSE NULL 
   END) AS HS_CUST_COUNT
  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT
FROM(
    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD
    SELECT
       STR.STORE_NUM
      ,ca.FSCL_YR_NUM
      ,ca.FSCL_PER_IN_YR_NUM
      ,ca.FSCL_PER_CNT_NUM
      ,POSH2.GUID_ID
    FROM APPCA.F_POS_HDR POSH2
    LEFT OUTER JOIN APPCA.D_STORE_VERS STR
      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY
    INNER JOIN APPCA.D_CAL ca
      ON POSH2.BUS_DT = ca.CAL_DT
    WHERE STR.OWNR_TYPE_CD = 'CO'
      AND STR.CNTRY_CD_2_DGT_ISO = 'US'
      AND POSH2.GROSS_REV_LCL_AMT &gt; 0
       AND ca.FSCL_YR_NUM = 2018 
       AND ca.FSCL_PER_IN_YR_NUM = 4
    
    GROUP BY
       STR.STORE_NUM
      ,ca.FSCL_YR_NUM
      ,ca.FSCL_PER_IN_YR_NUM
      ,ca.FSCL_PER_CNT_NUM
      ,POSH2.GUID_ID
    ) T3
  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES
  INNER JOIN (
    SELECT
       T1.GUID_ID
      ,T1.FSCL_YR_NUM
      ,T1.FSCL_PER_IN_YR_NUM
      ,T1.FSCL_PER_CNT_NUM
      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 
         THEN T1.STORE_NUM 
         ELSE NULL 
       END) AS HOME_STORE
      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 
         THEN T1.N_TRANS 
         ELSE NULL 
       END) AS HOME_STORE_VISITS
      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 
         THEN T1.TOT_SPEND 
         ELSE NULL 
       END) AS HOME_STORE_SPEND
      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS
      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND
    FROM(
      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES
      SELECT
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ,ca.FSCL_PER_CNT_NUM
        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS
        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND
        --this ranks each store that the guid has visited by the number of transactions and spend
        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM 
                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), 
                           -SUM(POSH.GROSS_REV_LCL_AMT)
                  ) 
         AS RNK_HS
      FROM APPCA.F_POS_HDR POSH
      LEFT OUTER JOIN APPCA.D_STORE_VERS STR
        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY
      INNER JOIN APPCA.D_CAL ca
        ON POSH.BUS_DT = ca.CAL_DT
      WHERE STR.OWNR_TYPE_CD = 'CO'
        AND STR.CNTRY_CD_2_DGT_ISO = 'US'
        AND POSH.GROSS_REV_LCL_AMT &gt; 0
       AND ca.FSCL_YR_NUM = 2018 
       AND ca.FSCL_PER_IN_YR_NUM = 4
        
      GROUP BY
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ,ca.FSCL_PER_CNT_NUM
    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC
    GROUP BY
       T1.GUID_ID
      ,T1.FSCL_YR_NUM
      ,T1.FSCL_PER_IN_YR_NUM
      ,T1.FSCL_PER_CNT_NUM
  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS
ON T2.GUID_ID = T3.GUID_ID
  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM

WHERE T2.GUID_ID IS NOT NULL 
  AND T3.GUID_ID IS NOT NULL 
  AND T2.GUID_ID !='0' 
  AND T3.GUID_ID !='0' 

GROUP BY
   T3.STORE_NUM
  ,T3.FSCL_YR_NUM
  ,T3.FSCL_PER_IN_YR_NUM
  ,T3.FSCL_PER_CNT_NUM</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--/* % home store customers */&#xA;&#xA;SELECT&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM&#xA;  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 &#xA;       ELSE NULL &#xA;   END) AS HS_CUST_COUNT&#xA;  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT&#xA;FROM(&#xA;    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD&#xA;    SELECT&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    FROM APPCA.F_POS_HDR POSH2&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;    INNER JOIN APPCA.D_CAL ca&#xA;      ON POSH2.BUS_DT = ca.CAL_DT&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;      AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;      AND POSH2.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;    &#xA;    GROUP BY&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    ) T3&#xA;  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES&#xA;  INNER JOIN (&#xA;    SELECT&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.STORE_NUM &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.N_TRANS &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_VISITS&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.TOT_SPEND &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_SPEND&#xA;      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS&#xA;      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND&#xA;    FROM(&#xA;      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES&#xA;      SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND&#xA;        --this ranks each store that the guid has visited by the number of transactions and spend&#xA;        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM &#xA;                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), &#xA;                           -SUM(POSH.GROSS_REV_LCL_AMT)&#xA;                  ) &#xA;         AS RNK_HS&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC&#xA;    GROUP BY&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS&#xA;ON T2.GUID_ID = T3.GUID_ID&#xA;  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM&#xA;&#xA;WHERE T2.GUID_ID IS NOT NULL &#xA;  AND T3.GUID_ID IS NOT NULL &#xA;  AND T2.GUID_ID !='0' &#xA;  AND T3.GUID_ID !='0' &#xA;&#xA;GROUP BY&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM" type="Double" />
            <Field name="FSCL_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--/* % home store customers */&#xA;&#xA;SELECT&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM&#xA;  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 &#xA;       ELSE NULL &#xA;   END) AS HS_CUST_COUNT&#xA;  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT&#xA;FROM(&#xA;    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD&#xA;    SELECT&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    FROM APPCA.F_POS_HDR POSH2&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;    INNER JOIN APPCA.D_CAL ca&#xA;      ON POSH2.BUS_DT = ca.CAL_DT&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;      AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;      AND POSH2.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;    &#xA;    GROUP BY&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    ) T3&#xA;  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES&#xA;  INNER JOIN (&#xA;    SELECT&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.STORE_NUM &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.N_TRANS &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_VISITS&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.TOT_SPEND &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_SPEND&#xA;      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS&#xA;      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND&#xA;    FROM(&#xA;      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES&#xA;      SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND&#xA;        --this ranks each store that the guid has visited by the number of transactions and spend&#xA;        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM &#xA;                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), &#xA;                           -SUM(POSH.GROSS_REV_LCL_AMT)&#xA;                  ) &#xA;         AS RNK_HS&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC&#xA;    GROUP BY&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS&#xA;ON T2.GUID_ID = T3.GUID_ID&#xA;  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM&#xA;&#xA;WHERE T2.GUID_ID IS NOT NULL &#xA;  AND T3.GUID_ID IS NOT NULL &#xA;  AND T2.GUID_ID !='0' &#xA;  AND T3.GUID_ID !='0' &#xA;&#xA;GROUP BY&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM" type="Double" />
            <Field name="FSCL_PER_IN_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--/* % home store customers */&#xA;&#xA;SELECT&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM&#xA;  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 &#xA;       ELSE NULL &#xA;   END) AS HS_CUST_COUNT&#xA;  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT&#xA;FROM(&#xA;    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD&#xA;    SELECT&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    FROM APPCA.F_POS_HDR POSH2&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;    INNER JOIN APPCA.D_CAL ca&#xA;      ON POSH2.BUS_DT = ca.CAL_DT&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;      AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;      AND POSH2.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;    &#xA;    GROUP BY&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    ) T3&#xA;  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES&#xA;  INNER JOIN (&#xA;    SELECT&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.STORE_NUM &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.N_TRANS &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_VISITS&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.TOT_SPEND &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_SPEND&#xA;      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS&#xA;      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND&#xA;    FROM(&#xA;      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES&#xA;      SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND&#xA;        --this ranks each store that the guid has visited by the number of transactions and spend&#xA;        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM &#xA;                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), &#xA;                           -SUM(POSH.GROSS_REV_LCL_AMT)&#xA;                  ) &#xA;         AS RNK_HS&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC&#xA;    GROUP BY&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS&#xA;ON T2.GUID_ID = T3.GUID_ID&#xA;  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM&#xA;&#xA;WHERE T2.GUID_ID IS NOT NULL &#xA;  AND T3.GUID_ID IS NOT NULL &#xA;  AND T2.GUID_ID !='0' &#xA;  AND T3.GUID_ID !='0' &#xA;&#xA;GROUP BY&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM" type="Double" />
            <Field name="FSCL_PER_CNT_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--/* % home store customers */&#xA;&#xA;SELECT&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM&#xA;  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 &#xA;       ELSE NULL &#xA;   END) AS HS_CUST_COUNT&#xA;  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT&#xA;FROM(&#xA;    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD&#xA;    SELECT&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    FROM APPCA.F_POS_HDR POSH2&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;    INNER JOIN APPCA.D_CAL ca&#xA;      ON POSH2.BUS_DT = ca.CAL_DT&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;      AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;      AND POSH2.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;    &#xA;    GROUP BY&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    ) T3&#xA;  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES&#xA;  INNER JOIN (&#xA;    SELECT&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.STORE_NUM &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.N_TRANS &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_VISITS&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.TOT_SPEND &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_SPEND&#xA;      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS&#xA;      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND&#xA;    FROM(&#xA;      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES&#xA;      SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND&#xA;        --this ranks each store that the guid has visited by the number of transactions and spend&#xA;        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM &#xA;                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), &#xA;                           -SUM(POSH.GROSS_REV_LCL_AMT)&#xA;                  ) &#xA;         AS RNK_HS&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC&#xA;    GROUP BY&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS&#xA;ON T2.GUID_ID = T3.GUID_ID&#xA;  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM&#xA;&#xA;WHERE T2.GUID_ID IS NOT NULL &#xA;  AND T3.GUID_ID IS NOT NULL &#xA;  AND T2.GUID_ID !='0' &#xA;  AND T3.GUID_ID !='0' &#xA;&#xA;GROUP BY&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM" type="Double" />
            <Field name="HS_CUST_COUNT" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--/* % home store customers */&#xA;&#xA;SELECT&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM&#xA;  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 &#xA;       ELSE NULL &#xA;   END) AS HS_CUST_COUNT&#xA;  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT&#xA;FROM(&#xA;    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD&#xA;    SELECT&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    FROM APPCA.F_POS_HDR POSH2&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;    INNER JOIN APPCA.D_CAL ca&#xA;      ON POSH2.BUS_DT = ca.CAL_DT&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;      AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;      AND POSH2.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;    &#xA;    GROUP BY&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    ) T3&#xA;  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES&#xA;  INNER JOIN (&#xA;    SELECT&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.STORE_NUM &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.N_TRANS &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_VISITS&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.TOT_SPEND &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_SPEND&#xA;      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS&#xA;      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND&#xA;    FROM(&#xA;      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES&#xA;      SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND&#xA;        --this ranks each store that the guid has visited by the number of transactions and spend&#xA;        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM &#xA;                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), &#xA;                           -SUM(POSH.GROSS_REV_LCL_AMT)&#xA;                  ) &#xA;         AS RNK_HS&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC&#xA;    GROUP BY&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS&#xA;ON T2.GUID_ID = T3.GUID_ID&#xA;  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM&#xA;&#xA;WHERE T2.GUID_ID IS NOT NULL &#xA;  AND T3.GUID_ID IS NOT NULL &#xA;  AND T2.GUID_ID !='0' &#xA;  AND T3.GUID_ID !='0' &#xA;&#xA;GROUP BY&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM" type="Double" />
            <Field name="ALL_CUST_COUNT" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--/* % home store customers */&#xA;&#xA;SELECT&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM&#xA;  ,SUM(CASE WHEN T2.HOME_STORE = T3.STORE_NUM THEN 1 &#xA;       ELSE NULL &#xA;   END) AS HS_CUST_COUNT&#xA;  ,COUNT(DISTINCT T2.GUID_ID) AS ALL_CUST_COUNT&#xA;FROM(&#xA;    --LIST OF ALL ACTIVE STORES AND GUIDS WHO VISITED THOSE STORES DURING THE GIVEN TIME PERIOD&#xA;    SELECT&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    FROM APPCA.F_POS_HDR POSH2&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;      ON POSH2.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;    INNER JOIN APPCA.D_CAL ca&#xA;      ON POSH2.BUS_DT = ca.CAL_DT&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;      AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;      AND POSH2.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;    &#xA;    GROUP BY&#xA;       STR.STORE_NUM&#xA;      ,ca.FSCL_YR_NUM&#xA;      ,ca.FSCL_PER_IN_YR_NUM&#xA;      ,ca.FSCL_PER_CNT_NUM&#xA;      ,POSH2.GUID_ID&#xA;    ) T3&#xA;  --JOINING LIST OF GUIDS WHO WERE ACTIVE, THEIR HOMESTORE, TOTAL TRANSACTIONS AND SPEND AT ALL STORES&#xA;  INNER JOIN (&#xA;    SELECT&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.STORE_NUM &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.N_TRANS &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_VISITS&#xA;      ,SUM(CASE WHEN T1.RNK_HS = 1 AND T1.N_TRANS&gt;=3 &#xA;         THEN T1.TOT_SPEND &#xA;         ELSE NULL &#xA;       END) AS HOME_STORE_SPEND&#xA;      ,SUM(T1.N_TRANS) AS ALL_STORES_VISITS&#xA;      ,SUM(T1.TOT_SPEND) AS ALL_STORES_SPEND&#xA;    FROM(&#xA;      --INNER QUERY - ALL GUIDS, STORES THEY VISITED, # TRANSACTIONS AT THOSE STORES AND TOTAL SPEND AT THOSE STORES&#xA;      SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;        ,SUM(POSH.GROSS_REV_LCL_AMT) AS TOT_SPEND&#xA;        --this ranks each store that the guid has visited by the number of transactions and spend&#xA;        ,RANK() OVER(PARTITION BY POSH.GUID_ID, ca.FSCL_PER_CNT_NUM &#xA;                  ORDER BY -COUNT(DISTINCT POSH.TRANS_ID), &#xA;                           -SUM(POSH.GROSS_REV_LCL_AMT)&#xA;                  ) &#xA;         AS RNK_HS&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,ca.FSCL_PER_CNT_NUM&#xA;    ) T1 --THIS IS THE LIST OF GUIDS AND THEIR HOMESTORE,SPEND ETC&#xA;    GROUP BY&#xA;       T1.GUID_ID&#xA;      ,T1.FSCL_YR_NUM&#xA;      ,T1.FSCL_PER_IN_YR_NUM&#xA;      ,T1.FSCL_PER_CNT_NUM&#xA;  ) T2 --THIS IS THE LIST OF ALL STORES AND THEIR CUSTOMERS&#xA;ON T2.GUID_ID = T3.GUID_ID&#xA;  AND T2.FSCL_PER_CNT_NUM = T3.FSCL_PER_CNT_NUM&#xA;&#xA;WHERE T2.GUID_ID IS NOT NULL &#xA;  AND T3.GUID_ID IS NOT NULL &#xA;  AND T2.GUID_ID !='0' &#xA;  AND T3.GUID_ID !='0' &#xA;&#xA;GROUP BY&#xA;   T3.STORE_NUM&#xA;  ,T3.FSCL_YR_NUM&#xA;  ,T3.FSCL_PER_IN_YR_NUM&#xA;  ,T3.FSCL_PER_CNT_NUM" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="2">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="174" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_ae0a604e1ba14d19984903a3d1f4f9d6_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="3">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="54" y="54" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text><![CDATA[Home Store
]]></Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="4">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="54" y="102" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pull percent home store customers at the store level for FEB FY18.</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="5">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="258" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411

 SELECT ca.FSCL_YR_NUM
        , SUM(f.CUST_TRANS_CNT) "CustTrans"
        , SUM(f.ACTIVE_STORE_DAY_CNT) "day_count"
        , ca.FSCL_PER_IN_YR_NUM
        , org.STORE_NUM
        , org.RGN_ORG_LVL_ID
        , org.RGN_ORG_LVL_DESCR
    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      
        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org
            ON f.STORE_NUMBER = org.STORE_NUM
            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores
        INNER JOIN APPDWH.ADT_CAL ca
            ON f.BUSINESS_DATE = ca.CAL_DT
            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)
        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp
            ON f.STORE_NUMBER = comp.STORE_NUMBER
            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE
            AND COMP_CODE = 'Y'
    GROUP BY ca.FSCL_YR_NUM
    , ca.FSCL_PER_IN_YR_NUM
    , org.STORE_NUM
    , org.RGN_ORG_LVL_ID
    , org.RGN_ORG_LVL_DESCR</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP411.world
Table=--SBP411

 SELECT ca.FSCL_YR_NUM
        , SUM(f.CUST_TRANS_CNT) "CustTrans"
        , SUM(f.ACTIVE_STORE_DAY_CNT) "day_count"
        , ca.FSCL_PER_IN_YR_NUM
        , org.STORE_NUM
        , org.RGN_ORG_LVL_ID
        , org.RGN_ORG_LVL_DESCR
    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      
        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org
            ON f.STORE_NUMBER = org.STORE_NUM
            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores
        INNER JOIN APPDWH.ADT_CAL ca
            ON f.BUSINESS_DATE = ca.CAL_DT
            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)
        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp
            ON f.STORE_NUMBER = comp.STORE_NUMBER
            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE
            AND COMP_CODE = 'Y'
    GROUP BY ca.FSCL_YR_NUM
    , ca.FSCL_PER_IN_YR_NUM
    , org.STORE_NUM
    , org.RGN_ORG_LVL_ID
    , org.RGN_ORG_LVL_DESCR</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="FSCL_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="Int64" />
            <Field name="CustTrans" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="Double" />
            <Field name="day_count" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="Double" />
            <Field name="FSCL_PER_IN_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="Int64" />
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="Int64" />
            <Field name="RGN_ORG_LVL_ID" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="Double" />
            <Field name="RGN_ORG_LVL_DESCR" size="81" source="File: oci:JUMORRIS/__EncPwd1__@SBP411.world|||--SBP411&#xA;&#xA; SELECT ca.FSCL_YR_NUM&#xA;        , SUM(f.CUST_TRANS_CNT) &quot;CustTrans&quot;&#xA;        , SUM(f.ACTIVE_STORE_DAY_CNT) &quot;day_count&quot;&#xA;        , ca.FSCL_PER_IN_YR_NUM&#xA;        , org.STORE_NUM&#xA;        , org.RGN_ORG_LVL_ID&#xA;        , org.RGN_ORG_LVL_DESCR&#xA;    FROM APPBUS.DFT_INTL_STORE_DAY_VW f      &#xA;        INNER JOIN APPDWH.DDM_RETAIL_ORG_STORE_DIST org&#xA;            ON f.STORE_NUMBER = org.STORE_NUM&#xA;            AND org.DIV_ORG_LVL_ID IN (3,6,106)  -- US CO stores&#xA;        INNER JOIN APPDWH.ADT_CAL ca&#xA;            ON f.BUSINESS_DATE = ca.CAL_DT&#xA;            AND ca.FSCL_YR_NUM IN (2017,2018) AND ca.FSCL_PER_IN_YR_NUM IN (3,4,5)&#xA;        INNER JOIN APPBUS.AFT_STORE_COMP_PER_VW comp&#xA;            ON f.STORE_NUMBER = comp.STORE_NUMBER&#xA;            AND ca.FSCL_PER_BEG_DT = comp.FISCAL_PERIOD_BEGIN_DATE&#xA;            AND COMP_CODE = 'Y'&#xA;    GROUP BY ca.FSCL_YR_NUM&#xA;    , ca.FSCL_PER_IN_YR_NUM&#xA;    , org.STORE_NUM&#xA;    , org.RGN_ORG_LVL_ID&#xA;    , org.RGN_ORG_LVL_DESCR" type="V_WString" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="6">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="378" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_81b51e64d5d44a97af1b2e05c378335e_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="7">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="258" y="54" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>TSDs and Region</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="8">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="258" y="102" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls TSDs and Region at the store level for FEB FY18 and FY17 (for TSD comp).</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="11">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="462" y="54" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Speed Scores</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="12">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="462" y="102" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls Speed TB and response counts at the store level.</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="13">
      <GuiSettings Plugin="AlteryxRPluginGui.R">
        <Position x="726" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <RScript />
          <UseFullUpdate value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxRPluginEngine.dll" EngineDllEntryPoint="AlteryxR" />
    </Node>
    <Node ToolID="14">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="702" y="54" width="100" height="48" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Drivers of Speed</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="15">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="702" y="114" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Analyses for drivers of speed work</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="16">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="678" y="342" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17"><![CDATA[oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP414/411

WITH prtnr AS 
(SELECT DISTINCT
      SAP_PRTNR_ID
      ,ORIG_HIRE_DT
      ,MOST_RECENT_HIRE_DT
      FROM D_PRTNR_VERS
      WHERE EMP_STAT_CD = 'Active'
 ) SELECT 
      prtnr.SAP_PRTNR_ID AS PRTNR_NUM
      ,prtnr.ORIG_HIRE_DT
      ,prtnr.MOST_RECENT_HIRE_DT
      ,gls.STORE_NUM
      ,gls.JOB_ID

FROM prtnr

INNER JOIN (
  SELECT * FROM (
    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,
    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec
    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  
    WHERE CNTRY_CD = 'US'
      AND BUS_DT >= '10-APR-17'  --one week prior to launch of Pulse
      AND JOB_ID IN (50000362,50000358,50000117)
    ) WHERE mostrec = 1
  ) gls 
  
ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM
]]></File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText><![CDATA[Database: @SBP415.WORLD
Table=--SBP414/411

WITH prtnr AS 
(SELECT DISTINCT
      SAP_PRTNR_ID
      ,ORIG_HIRE_DT
      ,MOST_RECENT_HIRE_DT
      FROM D_PRTNR_VERS
      WHERE EMP_STAT_CD = 'Active'
 ) SELECT 
      prtnr.SAP_PRTNR_ID AS PRTNR_NUM
      ,prtnr.ORIG_HIRE_DT
      ,prtnr.MOST_RECENT_HIRE_DT
      ,gls.STORE_NUM
      ,gls.JOB_ID

FROM prtnr

INNER JOIN (
  SELECT * FROM (
    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,
    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec
    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  
    WHERE CNTRY_CD = 'US'
      AND BUS_DT >= '10-APR-17'  --one week prior to launch of Pulse
      AND JOB_ID IN (50000362,50000358,50000117)
    ) WHERE mostrec = 1
  ) gls 
  
ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM
]]></DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="PRTNR_NUM" size="21" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP414/411&#xA;&#xA;WITH prtnr AS &#xA;(SELECT DISTINCT&#xA;      SAP_PRTNR_ID&#xA;      ,ORIG_HIRE_DT&#xA;      ,MOST_RECENT_HIRE_DT&#xA;      FROM D_PRTNR_VERS&#xA;      WHERE EMP_STAT_CD = 'Active'&#xA; ) SELECT &#xA;      prtnr.SAP_PRTNR_ID AS PRTNR_NUM&#xA;      ,prtnr.ORIG_HIRE_DT&#xA;      ,prtnr.MOST_RECENT_HIRE_DT&#xA;      ,gls.STORE_NUM&#xA;      ,gls.JOB_ID&#xA;&#xA;FROM prtnr&#xA;&#xA;INNER JOIN (&#xA;  SELECT * FROM (&#xA;    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,&#xA;    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec&#xA;    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  &#xA;    WHERE CNTRY_CD = 'US'&#xA;      AND BUS_DT &gt;= '10-APR-17'  --one week prior to launch of Pulse&#xA;      AND JOB_ID IN (50000362,50000358,50000117)&#xA;    ) WHERE mostrec = 1&#xA;  ) gls &#xA;  &#xA;ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM&#xA;" type="WString" />
            <Field name="ORIG_HIRE_DT" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP414/411&#xA;&#xA;WITH prtnr AS &#xA;(SELECT DISTINCT&#xA;      SAP_PRTNR_ID&#xA;      ,ORIG_HIRE_DT&#xA;      ,MOST_RECENT_HIRE_DT&#xA;      FROM D_PRTNR_VERS&#xA;      WHERE EMP_STAT_CD = 'Active'&#xA; ) SELECT &#xA;      prtnr.SAP_PRTNR_ID AS PRTNR_NUM&#xA;      ,prtnr.ORIG_HIRE_DT&#xA;      ,prtnr.MOST_RECENT_HIRE_DT&#xA;      ,gls.STORE_NUM&#xA;      ,gls.JOB_ID&#xA;&#xA;FROM prtnr&#xA;&#xA;INNER JOIN (&#xA;  SELECT * FROM (&#xA;    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,&#xA;    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec&#xA;    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  &#xA;    WHERE CNTRY_CD = 'US'&#xA;      AND BUS_DT &gt;= '10-APR-17'  --one week prior to launch of Pulse&#xA;      AND JOB_ID IN (50000362,50000358,50000117)&#xA;    ) WHERE mostrec = 1&#xA;  ) gls &#xA;  &#xA;ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM&#xA;" type="DateTime" />
            <Field name="MOST_RECENT_HIRE_DT" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP414/411&#xA;&#xA;WITH prtnr AS &#xA;(SELECT DISTINCT&#xA;      SAP_PRTNR_ID&#xA;      ,ORIG_HIRE_DT&#xA;      ,MOST_RECENT_HIRE_DT&#xA;      FROM D_PRTNR_VERS&#xA;      WHERE EMP_STAT_CD = 'Active'&#xA; ) SELECT &#xA;      prtnr.SAP_PRTNR_ID AS PRTNR_NUM&#xA;      ,prtnr.ORIG_HIRE_DT&#xA;      ,prtnr.MOST_RECENT_HIRE_DT&#xA;      ,gls.STORE_NUM&#xA;      ,gls.JOB_ID&#xA;&#xA;FROM prtnr&#xA;&#xA;INNER JOIN (&#xA;  SELECT * FROM (&#xA;    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,&#xA;    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec&#xA;    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  &#xA;    WHERE CNTRY_CD = 'US'&#xA;      AND BUS_DT &gt;= '10-APR-17'  --one week prior to launch of Pulse&#xA;      AND JOB_ID IN (50000362,50000358,50000117)&#xA;    ) WHERE mostrec = 1&#xA;  ) gls &#xA;  &#xA;ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM&#xA;" type="DateTime" />
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP414/411&#xA;&#xA;WITH prtnr AS &#xA;(SELECT DISTINCT&#xA;      SAP_PRTNR_ID&#xA;      ,ORIG_HIRE_DT&#xA;      ,MOST_RECENT_HIRE_DT&#xA;      FROM D_PRTNR_VERS&#xA;      WHERE EMP_STAT_CD = 'Active'&#xA; ) SELECT &#xA;      prtnr.SAP_PRTNR_ID AS PRTNR_NUM&#xA;      ,prtnr.ORIG_HIRE_DT&#xA;      ,prtnr.MOST_RECENT_HIRE_DT&#xA;      ,gls.STORE_NUM&#xA;      ,gls.JOB_ID&#xA;&#xA;FROM prtnr&#xA;&#xA;INNER JOIN (&#xA;  SELECT * FROM (&#xA;    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,&#xA;    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec&#xA;    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  &#xA;    WHERE CNTRY_CD = 'US'&#xA;      AND BUS_DT &gt;= '10-APR-17'  --one week prior to launch of Pulse&#xA;      AND JOB_ID IN (50000362,50000358,50000117)&#xA;    ) WHERE mostrec = 1&#xA;  ) gls &#xA;  &#xA;ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM&#xA;" type="Double" />
            <Field name="JOB_ID" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP414/411&#xA;&#xA;WITH prtnr AS &#xA;(SELECT DISTINCT&#xA;      SAP_PRTNR_ID&#xA;      ,ORIG_HIRE_DT&#xA;      ,MOST_RECENT_HIRE_DT&#xA;      FROM D_PRTNR_VERS&#xA;      WHERE EMP_STAT_CD = 'Active'&#xA; ) SELECT &#xA;      prtnr.SAP_PRTNR_ID AS PRTNR_NUM&#xA;      ,prtnr.ORIG_HIRE_DT&#xA;      ,prtnr.MOST_RECENT_HIRE_DT&#xA;      ,gls.STORE_NUM&#xA;      ,gls.JOB_ID&#xA;&#xA;FROM prtnr&#xA;&#xA;INNER JOIN (&#xA;  SELECT * FROM (&#xA;    SELECT PRTNR_NUM, STORE_NUM, JOB_ID,&#xA;    ROW_NUMBER() OVER (PARTITION BY PRTNR_NUM ORDER BY END_DTM DESC) AS mostrec&#xA;    FROM APPDWH.AFT_GLS_PRTNR_TMCARD@SBP411  &#xA;    WHERE CNTRY_CD = 'US'&#xA;      AND BUS_DT &gt;= '10-APR-17'  --one week prior to launch of Pulse&#xA;      AND JOB_ID IN (50000362,50000358,50000117)&#xA;    ) WHERE mostrec = 1&#xA;  ) gls &#xA;  &#xA;ON prtnr.SAP_PRTNR_ID = gls.PRTNR_NUM&#xA;" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="17">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="798" y="342" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_42696234480f46d9afbb49569aa48557_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="18">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="678" y="246" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Partner Tenure</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="19">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="678" y="294" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls partner tenure and assigned store</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="20">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="894" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */

/* SR Transaction Percent by Store */

WITH SQ AS
(SELECT
   ss.STORE_NUM
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tr.TRANS_ID
  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER

FROM APPCA.F_POS_HDR tr

INNER JOIN D_POS_HDR_TRANS_TYPE ty
  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY
  
INNER JOIN APPCA.D_STORE_VERS ss
  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY
  
INNER JOIN APPCA.D_CAL ca
  ON tr.BUS_DT = ca.CAL_DT

WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'
  AND ss.OWNR_TYPE_CD = 'CO'
  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15
  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1

GROUP BY
   ss.STORE_NUM
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tr.TRANS_ID
  ,tr.GUID_ID)
SELECT 
   SQ.STORE_NUM
  ,SQ.FSCL_YR_NUM
  ,SQ.FSCL_QTR_IN_YR_NUM
  ,SQ.SR_MEMBER
  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT
  
FROM SQ

GROUP BY
   SQ.STORE_NUM
  ,SQ.FSCL_YR_NUM
  ,SQ.FSCL_QTR_IN_YR_NUM
  ,SQ.SR_MEMBER

ORDER BY
   SQ.STORE_NUM
  ,SQ.SR_MEMBER</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=--/* CAW */

/* SR Transaction Percent by Store */

WITH SQ AS
(SELECT
   ss.STORE_NUM
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tr.TRANS_ID
  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER

FROM APPCA.F_POS_HDR tr

INNER JOIN D_POS_HDR_TRANS_TYPE ty
  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY
  
INNER JOIN APPCA.D_STORE_VERS ss
  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY
  
INNER JOIN APPCA.D_CAL ca
  ON tr.BUS_DT = ca.CAL_DT

WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'
  AND ss.OWNR_TYPE_CD = 'CO'
  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15
  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1

GROUP BY
   ss.STORE_NUM
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tr.TRANS_ID
  ,tr.GUID_ID)
SELECT 
   SQ.STORE_NUM
  ,SQ.FSCL_YR_NUM
  ,SQ.FSCL_QTR_IN_YR_NUM
  ,SQ.SR_MEMBER
  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT
  
FROM SQ

GROUP BY
   SQ.STORE_NUM
  ,SQ.FSCL_YR_NUM
  ,SQ.FSCL_QTR_IN_YR_NUM
  ,SQ.SR_MEMBER

ORDER BY
   SQ.STORE_NUM
  ,SQ.SR_MEMBER</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;/* SR Transaction Percent by Store */&#xA;&#xA;WITH SQ AS&#xA;(SELECT&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER&#xA;&#xA;FROM APPCA.F_POS_HDR tr&#xA;&#xA;INNER JOIN D_POS_HDR_TRANS_TYPE ty&#xA;  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY&#xA;  &#xA;INNER JOIN APPCA.D_STORE_VERS ss&#xA;  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY&#xA;  &#xA;INNER JOIN APPCA.D_CAL ca&#xA;  ON tr.BUS_DT = ca.CAL_DT&#xA;&#xA;WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND ss.OWNR_TYPE_CD = 'CO'&#xA;  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15&#xA;  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;&#xA;GROUP BY&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,tr.GUID_ID)&#xA;SELECT &#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT&#xA;  &#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;&#xA;ORDER BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.SR_MEMBER" type="Double" />
            <Field name="FSCL_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;/* SR Transaction Percent by Store */&#xA;&#xA;WITH SQ AS&#xA;(SELECT&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER&#xA;&#xA;FROM APPCA.F_POS_HDR tr&#xA;&#xA;INNER JOIN D_POS_HDR_TRANS_TYPE ty&#xA;  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY&#xA;  &#xA;INNER JOIN APPCA.D_STORE_VERS ss&#xA;  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY&#xA;  &#xA;INNER JOIN APPCA.D_CAL ca&#xA;  ON tr.BUS_DT = ca.CAL_DT&#xA;&#xA;WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND ss.OWNR_TYPE_CD = 'CO'&#xA;  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15&#xA;  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;&#xA;GROUP BY&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,tr.GUID_ID)&#xA;SELECT &#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT&#xA;  &#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;&#xA;ORDER BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.SR_MEMBER" type="Double" />
            <Field name="FSCL_QTR_IN_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;/* SR Transaction Percent by Store */&#xA;&#xA;WITH SQ AS&#xA;(SELECT&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER&#xA;&#xA;FROM APPCA.F_POS_HDR tr&#xA;&#xA;INNER JOIN D_POS_HDR_TRANS_TYPE ty&#xA;  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY&#xA;  &#xA;INNER JOIN APPCA.D_STORE_VERS ss&#xA;  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY&#xA;  &#xA;INNER JOIN APPCA.D_CAL ca&#xA;  ON tr.BUS_DT = ca.CAL_DT&#xA;&#xA;WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND ss.OWNR_TYPE_CD = 'CO'&#xA;  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15&#xA;  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;&#xA;GROUP BY&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,tr.GUID_ID)&#xA;SELECT &#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT&#xA;  &#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;&#xA;ORDER BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.SR_MEMBER" type="Double" />
            <Field name="SR_MEMBER" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;/* SR Transaction Percent by Store */&#xA;&#xA;WITH SQ AS&#xA;(SELECT&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER&#xA;&#xA;FROM APPCA.F_POS_HDR tr&#xA;&#xA;INNER JOIN D_POS_HDR_TRANS_TYPE ty&#xA;  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY&#xA;  &#xA;INNER JOIN APPCA.D_STORE_VERS ss&#xA;  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY&#xA;  &#xA;INNER JOIN APPCA.D_CAL ca&#xA;  ON tr.BUS_DT = ca.CAL_DT&#xA;&#xA;WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND ss.OWNR_TYPE_CD = 'CO'&#xA;  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15&#xA;  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;&#xA;GROUP BY&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,tr.GUID_ID)&#xA;SELECT &#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT&#xA;  &#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;&#xA;ORDER BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.SR_MEMBER" type="Double" />
            <Field name="TTL_TRANS_CNT" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;/* SR Transaction Percent by Store */&#xA;&#xA;WITH SQ AS&#xA;(SELECT&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,(CASE WHEN tr.GUID_ID = '0' THEN 0 ELSE 1 END) AS SR_MEMBER&#xA;&#xA;FROM APPCA.F_POS_HDR tr&#xA;&#xA;INNER JOIN D_POS_HDR_TRANS_TYPE ty&#xA;  ON tr.POS_HDR_TRANS_TYPE_KEY = ty.POS_HDR_TRANS_TYPE_KEY&#xA;  &#xA;INNER JOIN APPCA.D_STORE_VERS ss&#xA;  ON ss.STORE_VERS_KEY = tr.STORE_VERS_KEY&#xA;  &#xA;INNER JOIN APPCA.D_CAL ca&#xA;  ON tr.BUS_DT = ca.CAL_DT&#xA;&#xA;WHERE ss.CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND ss.OWNR_TYPE_CD = 'CO'&#xA;  AND ss.STORE_OPEN_DT &lt; '29-JUN-15'  -- beginning of Q4FY15&#xA;  AND ca.FSCL_YR_NUM = 2018 AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;&#xA;GROUP BY&#xA;   ss.STORE_NUM&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tr.TRANS_ID&#xA;  ,tr.GUID_ID)&#xA;SELECT &#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;  ,COUNT(DISTINCT SQ.TRANS_ID) AS TTL_TRANS_CNT&#xA;  &#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.FSCL_YR_NUM&#xA;  ,SQ.FSCL_QTR_IN_YR_NUM&#xA;  ,SQ.SR_MEMBER&#xA;&#xA;ORDER BY&#xA;   SQ.STORE_NUM&#xA;  ,SQ.SR_MEMBER" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="21">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="1014" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_ef5e7eb6992a4b5a98fdd48da92f6f16_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="22">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="894" y="54" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text><![CDATA[SR Trans
]]></Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="23">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="894" y="114" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls total transaction count by SR members and non-SR members at the store level</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="24">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="1326" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */
--SBP416

WITH SQ AS
      (SELECT
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS

      FROM APPCA.F_POS_HDR POSH
      LEFT OUTER JOIN APPCA.D_STORE_VERS STR
        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY
      INNER JOIN APPCA.D_CAL ca
        ON POSH.BUS_DT = ca.CAL_DT
      WHERE STR.OWNR_TYPE_CD = 'CO'
        AND STR.CNTRY_CD_2_DGT_ISO = 'US'
        AND POSH.GROSS_REV_LCL_AMT &gt; 0
       AND ca.FSCL_YR_NUM = 2018 
       AND ca.FSCL_PER_IN_YR_NUM = 4
        
      GROUP BY
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ), SQ2 AS
(SELECT 
 SQ.STORE_NUM
,SQ.FSCL_YR_NUM
,SQ.FSCL_PER_IN_YR_NUM
,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0
      WHEN SQ.N_TRANS &gt;= 26 THEN 1
      END) AS HIGH_TRANS_CUST
,SQ.GUID_ID

FROM SQ

GROUP BY
 SQ.STORE_NUM
,SQ.FSCL_YR_NUM
,SQ.FSCL_PER_IN_YR_NUM
,SQ.N_TRANS
,SQ.GUID_ID)
SELECT 
 SQ2.STORE_NUM
,SQ2.FSCL_YR_NUM
,SQ2.FSCL_PER_IN_YR_NUM
,SQ2.HIGH_TRANS_CUST
,COUNT(GUID_ID) AS N_CUST
FROM SQ2
GROUP BY 
 SQ2.STORE_NUM
,SQ2.FSCL_YR_NUM
,SQ2.FSCL_PER_IN_YR_NUM
,SQ2.HIGH_TRANS_CUST</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=--/* CAW */
--SBP416

WITH SQ AS
      (SELECT
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS

      FROM APPCA.F_POS_HDR POSH
      LEFT OUTER JOIN APPCA.D_STORE_VERS STR
        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY
      INNER JOIN APPCA.D_CAL ca
        ON POSH.BUS_DT = ca.CAL_DT
      WHERE STR.OWNR_TYPE_CD = 'CO'
        AND STR.CNTRY_CD_2_DGT_ISO = 'US'
        AND POSH.GROSS_REV_LCL_AMT &gt; 0
       AND ca.FSCL_YR_NUM = 2018 
       AND ca.FSCL_PER_IN_YR_NUM = 4
        
      GROUP BY
         POSH.GUID_ID
        ,STR.STORE_NUM
        ,ca.FSCL_YR_NUM
        ,ca.FSCL_PER_IN_YR_NUM
        ), SQ2 AS
(SELECT 
 SQ.STORE_NUM
,SQ.FSCL_YR_NUM
,SQ.FSCL_PER_IN_YR_NUM
,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0
      WHEN SQ.N_TRANS &gt;= 26 THEN 1
      END) AS HIGH_TRANS_CUST
,SQ.GUID_ID

FROM SQ

GROUP BY
 SQ.STORE_NUM
,SQ.FSCL_YR_NUM
,SQ.FSCL_PER_IN_YR_NUM
,SQ.N_TRANS
,SQ.GUID_ID)
SELECT 
 SQ2.STORE_NUM
,SQ2.FSCL_YR_NUM
,SQ2.FSCL_PER_IN_YR_NUM
,SQ2.HIGH_TRANS_CUST
,COUNT(GUID_ID) AS N_CUST
FROM SQ2
GROUP BY 
 SQ2.STORE_NUM
,SQ2.FSCL_YR_NUM
,SQ2.FSCL_PER_IN_YR_NUM
,SQ2.HIGH_TRANS_CUST</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--SBP416&#xA;&#xA;WITH SQ AS&#xA;      (SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ), SQ2 AS&#xA;(SELECT &#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0&#xA;      WHEN SQ.N_TRANS &gt;= 26 THEN 1&#xA;      END) AS HIGH_TRANS_CUST&#xA;,SQ.GUID_ID&#xA;&#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,SQ.N_TRANS&#xA;,SQ.GUID_ID)&#xA;SELECT &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST&#xA;,COUNT(GUID_ID) AS N_CUST&#xA;FROM SQ2&#xA;GROUP BY &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST" type="Double" />
            <Field name="FSCL_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--SBP416&#xA;&#xA;WITH SQ AS&#xA;      (SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ), SQ2 AS&#xA;(SELECT &#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0&#xA;      WHEN SQ.N_TRANS &gt;= 26 THEN 1&#xA;      END) AS HIGH_TRANS_CUST&#xA;,SQ.GUID_ID&#xA;&#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,SQ.N_TRANS&#xA;,SQ.GUID_ID)&#xA;SELECT &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST&#xA;,COUNT(GUID_ID) AS N_CUST&#xA;FROM SQ2&#xA;GROUP BY &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST" type="Double" />
            <Field name="FSCL_PER_IN_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--SBP416&#xA;&#xA;WITH SQ AS&#xA;      (SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ), SQ2 AS&#xA;(SELECT &#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0&#xA;      WHEN SQ.N_TRANS &gt;= 26 THEN 1&#xA;      END) AS HIGH_TRANS_CUST&#xA;,SQ.GUID_ID&#xA;&#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,SQ.N_TRANS&#xA;,SQ.GUID_ID)&#xA;SELECT &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST&#xA;,COUNT(GUID_ID) AS N_CUST&#xA;FROM SQ2&#xA;GROUP BY &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST" type="Double" />
            <Field name="HIGH_TRANS_CUST" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--SBP416&#xA;&#xA;WITH SQ AS&#xA;      (SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ), SQ2 AS&#xA;(SELECT &#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0&#xA;      WHEN SQ.N_TRANS &gt;= 26 THEN 1&#xA;      END) AS HIGH_TRANS_CUST&#xA;,SQ.GUID_ID&#xA;&#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,SQ.N_TRANS&#xA;,SQ.GUID_ID)&#xA;SELECT &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST&#xA;,COUNT(GUID_ID) AS N_CUST&#xA;FROM SQ2&#xA;GROUP BY &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST" type="Double" />
            <Field name="N_CUST" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;--SBP416&#xA;&#xA;WITH SQ AS&#xA;      (SELECT&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ,COUNT(DISTINCT POSH.TRANS_ID) AS N_TRANS&#xA;&#xA;      FROM APPCA.F_POS_HDR POSH&#xA;      LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;        ON POSH.STORE_VERS_KEY = STR.STORE_VERS_KEY&#xA;      INNER JOIN APPCA.D_CAL ca&#xA;        ON POSH.BUS_DT = ca.CAL_DT&#xA;      WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;        AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;        AND POSH.GROSS_REV_LCL_AMT &gt; 0&#xA;       AND ca.FSCL_YR_NUM = 2018 &#xA;       AND ca.FSCL_PER_IN_YR_NUM = 4&#xA;        &#xA;      GROUP BY&#xA;         POSH.GUID_ID&#xA;        ,STR.STORE_NUM&#xA;        ,ca.FSCL_YR_NUM&#xA;        ,ca.FSCL_PER_IN_YR_NUM&#xA;        ), SQ2 AS&#xA;(SELECT &#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,(CASE WHEN SQ.N_TRANS &lt; 26 THEN 0&#xA;      WHEN SQ.N_TRANS &gt;= 26 THEN 1&#xA;      END) AS HIGH_TRANS_CUST&#xA;,SQ.GUID_ID&#xA;&#xA;FROM SQ&#xA;&#xA;GROUP BY&#xA; SQ.STORE_NUM&#xA;,SQ.FSCL_YR_NUM&#xA;,SQ.FSCL_PER_IN_YR_NUM&#xA;,SQ.N_TRANS&#xA;,SQ.GUID_ID)&#xA;SELECT &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST&#xA;,COUNT(GUID_ID) AS N_CUST&#xA;FROM SQ2&#xA;GROUP BY &#xA; SQ2.STORE_NUM&#xA;,SQ2.FSCL_YR_NUM&#xA;,SQ2.FSCL_PER_IN_YR_NUM&#xA;,SQ2.HIGH_TRANS_CUST" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="25">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="1422" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_9f0356112e0e4e2f9a16fdb4311c2075_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="26">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1338" y="54" width="100" height="52" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>High Frequency Customers</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="27">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1338" y="114" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls number of customers that are &lt;26 trans/month versus number of customers that are &gt;=26 trans/month at the store level.</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="28">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="1110" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */

--/* CAW */

SELECT S3.STORE_NUM,
AVG(S3.N_ITEMS_TOTAL) AS N_ITEMS_TOTAL,
AVG(S3.N_ITEMS_BEV) AS N_ITEMS_BEV,
AVG(S3.N_ITEMS_FOOD) AS N_ITEMS_FOOD
FROM
(
  SELECT S2.*, 
  (POSH.TRANS_QTY) AS N_ITEMS_TOTAL,
  (POSH.TTL_BEV_QTY) AS N_ITEMS_BEV,
  (POSH.TTL_FOOD_QTY) AS N_ITEMS_FOOD
  FROM
  (
    SELECT S.GUID_USER_ID,
    S.CASE_ID,
    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)) AS TRANS_ID,
    S.STORE_NUM,
    C.CAL_DT,
    C.DAY_NM,
    C.WKDY_IND
    FROM APPOTHER.AFT_CV_SRVY_RSPNS S
    LEFT OUTER JOIN APPCA.D_STORE_VERS STR
    ON S.STORE_NUM = STR.STORE_NUM 
    LEFT OUTER JOIN APPOTHER.CUST_INS_WEIGHTS W
    ON S.CASE_ID = W.CASE_ID
    LEFT OUTER JOIN APPCA.D_CAL C
    ON TRUNC(S.TRANS_DTM) = TRUNC(C.CAL_DT)
    WHERE STR.OWNR_TYPE_CD = 'CO'
    AND STR.CNTRY_CD_2_DGT_ISO = 'US'
    AND STR.CURRENT_FLG = 'Y'
    AND TRUNC(S.TRANS_DTM) &gt;= '01-FEB-2018'
    AND TRUNC(S.TRANS_DTM) &lt;= '28-FEB-2018'
    GROUP BY S.GUID_USER_ID,
    S.CASE_ID,
    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)),
    S.STORE_NUM,
    C.CAL_DT,
    C.DAY_NM,
    C.WKDY_IND
  ) S2
  INNER JOIN APPCA.F_POS_HDR POSH
  ON S2.TRANS_ID = TO_CHAR(POSH.TRANS_ID)
  AND S2.GUID_USER_ID = POSH.GUID_ID
) S3
GROUP BY S3.STORE_NUM</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=--/* CAW */

--/* CAW */

SELECT S3.STORE_NUM,
AVG(S3.N_ITEMS_TOTAL) AS N_ITEMS_TOTAL,
AVG(S3.N_ITEMS_BEV) AS N_ITEMS_BEV,
AVG(S3.N_ITEMS_FOOD) AS N_ITEMS_FOOD
FROM
(
  SELECT S2.*, 
  (POSH.TRANS_QTY) AS N_ITEMS_TOTAL,
  (POSH.TTL_BEV_QTY) AS N_ITEMS_BEV,
  (POSH.TTL_FOOD_QTY) AS N_ITEMS_FOOD
  FROM
  (
    SELECT S.GUID_USER_ID,
    S.CASE_ID,
    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)) AS TRANS_ID,
    S.STORE_NUM,
    C.CAL_DT,
    C.DAY_NM,
    C.WKDY_IND
    FROM APPOTHER.AFT_CV_SRVY_RSPNS S
    LEFT OUTER JOIN APPCA.D_STORE_VERS STR
    ON S.STORE_NUM = STR.STORE_NUM 
    LEFT OUTER JOIN APPOTHER.CUST_INS_WEIGHTS W
    ON S.CASE_ID = W.CASE_ID
    LEFT OUTER JOIN APPCA.D_CAL C
    ON TRUNC(S.TRANS_DTM) = TRUNC(C.CAL_DT)
    WHERE STR.OWNR_TYPE_CD = 'CO'
    AND STR.CNTRY_CD_2_DGT_ISO = 'US'
    AND STR.CURRENT_FLG = 'Y'
    AND TRUNC(S.TRANS_DTM) &gt;= '01-FEB-2018'
    AND TRUNC(S.TRANS_DTM) &lt;= '28-FEB-2018'
    GROUP BY S.GUID_USER_ID,
    S.CASE_ID,
    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)),
    S.STORE_NUM,
    C.CAL_DT,
    C.DAY_NM,
    C.WKDY_IND
  ) S2
  INNER JOIN APPCA.F_POS_HDR POSH
  ON S2.TRANS_ID = TO_CHAR(POSH.TRANS_ID)
  AND S2.GUID_USER_ID = POSH.GUID_ID
) S3
GROUP BY S3.STORE_NUM</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" size="11" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;--/* CAW */&#xA;&#xA;SELECT S3.STORE_NUM,&#xA;AVG(S3.N_ITEMS_TOTAL) AS N_ITEMS_TOTAL,&#xA;AVG(S3.N_ITEMS_BEV) AS N_ITEMS_BEV,&#xA;AVG(S3.N_ITEMS_FOOD) AS N_ITEMS_FOOD&#xA;FROM&#xA;(&#xA;  SELECT S2.*, &#xA;  (POSH.TRANS_QTY) AS N_ITEMS_TOTAL,&#xA;  (POSH.TTL_BEV_QTY) AS N_ITEMS_BEV,&#xA;  (POSH.TTL_FOOD_QTY) AS N_ITEMS_FOOD&#xA;  FROM&#xA;  (&#xA;    SELECT S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)) AS TRANS_ID,&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;    FROM APPOTHER.AFT_CV_SRVY_RSPNS S&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;    ON S.STORE_NUM = STR.STORE_NUM &#xA;    LEFT OUTER JOIN APPOTHER.CUST_INS_WEIGHTS W&#xA;    ON S.CASE_ID = W.CASE_ID&#xA;    LEFT OUTER JOIN APPCA.D_CAL C&#xA;    ON TRUNC(S.TRANS_DTM) = TRUNC(C.CAL_DT)&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;    AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;    AND STR.CURRENT_FLG = 'Y'&#xA;    AND TRUNC(S.TRANS_DTM) &gt;= '01-FEB-2018'&#xA;    AND TRUNC(S.TRANS_DTM) &lt;= '28-FEB-2018'&#xA;    GROUP BY S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)),&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;  ) S2&#xA;  INNER JOIN APPCA.F_POS_HDR POSH&#xA;  ON S2.TRANS_ID = TO_CHAR(POSH.TRANS_ID)&#xA;  AND S2.GUID_USER_ID = POSH.GUID_ID&#xA;) S3&#xA;GROUP BY S3.STORE_NUM" type="WString" />
            <Field name="N_ITEMS_TOTAL" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;--/* CAW */&#xA;&#xA;SELECT S3.STORE_NUM,&#xA;AVG(S3.N_ITEMS_TOTAL) AS N_ITEMS_TOTAL,&#xA;AVG(S3.N_ITEMS_BEV) AS N_ITEMS_BEV,&#xA;AVG(S3.N_ITEMS_FOOD) AS N_ITEMS_FOOD&#xA;FROM&#xA;(&#xA;  SELECT S2.*, &#xA;  (POSH.TRANS_QTY) AS N_ITEMS_TOTAL,&#xA;  (POSH.TTL_BEV_QTY) AS N_ITEMS_BEV,&#xA;  (POSH.TTL_FOOD_QTY) AS N_ITEMS_FOOD&#xA;  FROM&#xA;  (&#xA;    SELECT S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)) AS TRANS_ID,&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;    FROM APPOTHER.AFT_CV_SRVY_RSPNS S&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;    ON S.STORE_NUM = STR.STORE_NUM &#xA;    LEFT OUTER JOIN APPOTHER.CUST_INS_WEIGHTS W&#xA;    ON S.CASE_ID = W.CASE_ID&#xA;    LEFT OUTER JOIN APPCA.D_CAL C&#xA;    ON TRUNC(S.TRANS_DTM) = TRUNC(C.CAL_DT)&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;    AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;    AND STR.CURRENT_FLG = 'Y'&#xA;    AND TRUNC(S.TRANS_DTM) &gt;= '01-FEB-2018'&#xA;    AND TRUNC(S.TRANS_DTM) &lt;= '28-FEB-2018'&#xA;    GROUP BY S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)),&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;  ) S2&#xA;  INNER JOIN APPCA.F_POS_HDR POSH&#xA;  ON S2.TRANS_ID = TO_CHAR(POSH.TRANS_ID)&#xA;  AND S2.GUID_USER_ID = POSH.GUID_ID&#xA;) S3&#xA;GROUP BY S3.STORE_NUM" type="Double" />
            <Field name="N_ITEMS_BEV" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;--/* CAW */&#xA;&#xA;SELECT S3.STORE_NUM,&#xA;AVG(S3.N_ITEMS_TOTAL) AS N_ITEMS_TOTAL,&#xA;AVG(S3.N_ITEMS_BEV) AS N_ITEMS_BEV,&#xA;AVG(S3.N_ITEMS_FOOD) AS N_ITEMS_FOOD&#xA;FROM&#xA;(&#xA;  SELECT S2.*, &#xA;  (POSH.TRANS_QTY) AS N_ITEMS_TOTAL,&#xA;  (POSH.TTL_BEV_QTY) AS N_ITEMS_BEV,&#xA;  (POSH.TTL_FOOD_QTY) AS N_ITEMS_FOOD&#xA;  FROM&#xA;  (&#xA;    SELECT S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)) AS TRANS_ID,&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;    FROM APPOTHER.AFT_CV_SRVY_RSPNS S&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;    ON S.STORE_NUM = STR.STORE_NUM &#xA;    LEFT OUTER JOIN APPOTHER.CUST_INS_WEIGHTS W&#xA;    ON S.CASE_ID = W.CASE_ID&#xA;    LEFT OUTER JOIN APPCA.D_CAL C&#xA;    ON TRUNC(S.TRANS_DTM) = TRUNC(C.CAL_DT)&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;    AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;    AND STR.CURRENT_FLG = 'Y'&#xA;    AND TRUNC(S.TRANS_DTM) &gt;= '01-FEB-2018'&#xA;    AND TRUNC(S.TRANS_DTM) &lt;= '28-FEB-2018'&#xA;    GROUP BY S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)),&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;  ) S2&#xA;  INNER JOIN APPCA.F_POS_HDR POSH&#xA;  ON S2.TRANS_ID = TO_CHAR(POSH.TRANS_ID)&#xA;  AND S2.GUID_USER_ID = POSH.GUID_ID&#xA;) S3&#xA;GROUP BY S3.STORE_NUM" type="Double" />
            <Field name="N_ITEMS_FOOD" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;--/* CAW */&#xA;&#xA;SELECT S3.STORE_NUM,&#xA;AVG(S3.N_ITEMS_TOTAL) AS N_ITEMS_TOTAL,&#xA;AVG(S3.N_ITEMS_BEV) AS N_ITEMS_BEV,&#xA;AVG(S3.N_ITEMS_FOOD) AS N_ITEMS_FOOD&#xA;FROM&#xA;(&#xA;  SELECT S2.*, &#xA;  (POSH.TRANS_QTY) AS N_ITEMS_TOTAL,&#xA;  (POSH.TTL_BEV_QTY) AS N_ITEMS_BEV,&#xA;  (POSH.TTL_FOOD_QTY) AS N_ITEMS_FOOD&#xA;  FROM&#xA;  (&#xA;    SELECT S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)) AS TRANS_ID,&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;    FROM APPOTHER.AFT_CV_SRVY_RSPNS S&#xA;    LEFT OUTER JOIN APPCA.D_STORE_VERS STR&#xA;    ON S.STORE_NUM = STR.STORE_NUM &#xA;    LEFT OUTER JOIN APPOTHER.CUST_INS_WEIGHTS W&#xA;    ON S.CASE_ID = W.CASE_ID&#xA;    LEFT OUTER JOIN APPCA.D_CAL C&#xA;    ON TRUNC(S.TRANS_DTM) = TRUNC(C.CAL_DT)&#xA;    WHERE STR.OWNR_TYPE_CD = 'CO'&#xA;    AND STR.CNTRY_CD_2_DGT_ISO = 'US'&#xA;    AND STR.CURRENT_FLG = 'Y'&#xA;    AND TRUNC(S.TRANS_DTM) &gt;= '01-FEB-2018'&#xA;    AND TRUNC(S.TRANS_DTM) &lt;= '28-FEB-2018'&#xA;    GROUP BY S.GUID_USER_ID,&#xA;    S.CASE_ID,&#xA;    TO_CHAR(S.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(S.STORE_NUM, '000000'))|| ltrim(TO_CHAR(S.RGSTR_NUM, '00')) || TRIM(to_char(S.TRANS_ID)),&#xA;    S.STORE_NUM,&#xA;    C.CAL_DT,&#xA;    C.DAY_NM,&#xA;    C.WKDY_IND&#xA;  ) S2&#xA;  INNER JOIN APPCA.F_POS_HDR POSH&#xA;  ON S2.TRANS_ID = TO_CHAR(POSH.TRANS_ID)&#xA;  AND S2.GUID_USER_ID = POSH.GUID_ID&#xA;) S3&#xA;GROUP BY S3.STORE_NUM" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="29">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="1230" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_3b05de9112df4e0c900e532490640c8f_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="30">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1110" y="54" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Product Mix</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="31">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1110" y="102" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls average number of beverage and food items sold per ticket (Feb 2018) at the store-level.</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="32">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="1518" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords />
          <File RecordLimit="" FileFormat="18">odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)

SELECT prtnr.[FY]
      ,prtnr.[FP]
      ,prtnr.[FP_End]
      ,prtnr.[Personnel Number] as PartnerID
	  --,prtnr.[FTE Salary]
	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE
      ,prtnr.[Status]
      ,prtnr.[Country]
      --,prtnr.[Company Code]
      ,prtnr.[Org_Unit]
      ,prtnr.[Org_Unit_Name]
	  ,prtnr.[Job_Number]
      ,prtnr.[Job_Title]
      ,prtnr.[Hire_Date]
      ,prtnr.[Job_Date]
      ,prtnr.[Position_Date]
	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */
	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'
	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'
	  ,org.[StoreAbbrev] as STORE_NUM
	  --,org.[StoreName]
      --,org.[DistrictOrgid]
      --,org.[DistrictAbbrev]
      --,org.[DistrictName]
      --,org.[AreaOrgid]
      --,org.[AreaAbbrev]
      --,org.[AreaName]
      --,org.[RegionOrgid]
      --,org.[RegionAbbrev]
      --,org.[RegionName]
      --,org.[DivisionOrgid]
      --,org.[DivisionAbbrev]
      --,org.[DivisionName]
  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr

   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org
		on prtnr.Org_Unit = org.StoreOrgid
	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'
		 AND prtnr.FY = 2018 and prtnr.FP = 4
		AND prtnr.Action_Group = 'Headcount'
		AND prtnr.Org_Segment = 'FMH'
		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */
		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */</File>
          <FormatSpecificOptions>
            <PreSQL />
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <TableStyle>Quoted</TableStyle>
            <ReadUncommitted>False</ReadUncommitted>
            <PostSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Source=MS10905
Catalog=PDW_Bulk
Table=--SBP415ss (PDW_Bulk)

SELECT prtnr.[FY]
      ,prtnr.[FP]
      ,prtnr.[FP_End]
      ,prtnr.[Personnel Number] as PartnerID
	  --,prtnr.[FTE Salary]
	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE
      ,prtnr.[Status]
      ,prtnr.[Country]
      --,prtnr.[Company Code]
      ,prtnr.[Org_Unit]
      ,prtnr.[Org_Unit_Name]
	  ,prtnr.[Job_Number]
      ,prtnr.[Job_Title]
      ,prtnr.[Hire_Date]
      ,prtnr.[Job_Date]
      ,prtnr.[Position_Date]
	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */
	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'
	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'
	  ,org.[StoreAbbrev] as STORE_NUM
	  --,org.[StoreName]
      --,org.[DistrictOrgid]
      --,org.[DistrictAbbrev]
      --,org.[DistrictName]
      --,org.[AreaOrgid]
      --,org.[AreaAbbrev]
      --,org.[AreaName]
      --,org.[RegionOrgid]
      --,org.[RegionAbbrev]
      --,org.[RegionName]
      --,org.[DivisionOrgid]
      --,org.[DivisionAbbrev]
      --,org.[DivisionName]
  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr

   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org
		on prtnr.Org_Unit = org.StoreOrgid
	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'
		 AND prtnr.FY = 2018 and prtnr.FP = 4
		AND prtnr.Action_Group = 'Headcount'
		AND prtnr.Org_Segment = 'FMH'
		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */
		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="FY" size="10" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="FP" size="10" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="FP_End" size="10" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="PartnerID" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Status" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Country" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Org_Unit" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Org_Unit_Name" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Job_Number" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Job_Title" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Hire_Date" size="10" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Job_Date" size="10" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="Position_Date" size="10" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
            <Field name="SbuxTenure" scale="8" size="24" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="FixedDecimal" />
            <Field name="JobTenure" scale="8" size="24" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="FixedDecimal" />
            <Field name="TimeInPosition" scale="8" size="24" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="FixedDecimal" />
            <Field name="STORE_NUM" size="255" source="File: odb:Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;User ID=jumorris;Initial Catalog=PDW_Bulk;Data Source=MS10905;Use Procedure for Prepare=1;Auto Translate=True;Packet Size=4096;Workstation ID=JUMORRIS-171012;Use Encryption for Data=False;Tag with column collation when possible=False|||--SBP415ss (PDW_Bulk)&#xA;&#xA;SELECT prtnr.[FY]&#xA;      ,prtnr.[FP]&#xA;      ,prtnr.[FP_End]&#xA;      ,prtnr.[Personnel Number] as PartnerID&#xA;	  --,prtnr.[FTE Salary]&#xA;	  --,ROUND((prtnr.[FTE Salary]/2080),2) AS HOURLY_RATE&#xA;      ,prtnr.[Status]&#xA;      ,prtnr.[Country]&#xA;      --,prtnr.[Company Code]&#xA;      ,prtnr.[Org_Unit]&#xA;      ,prtnr.[Org_Unit_Name]&#xA;	  ,prtnr.[Job_Number]&#xA;      ,prtnr.[Job_Title]&#xA;      ,prtnr.[Hire_Date]&#xA;      ,prtnr.[Job_Date]&#xA;      ,prtnr.[Position_Date]&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Hire_Date], prtnr.[FP_End])/365.2425), 2) as 'SbuxTenure' /* limitations: lack of transparency into first hire date for rehires. */&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Job_Date], prtnr.[FP_End])/365.2425), 2) as 'JobTenure'&#xA;	  , ROUND((DATEDIFF(DAY, prtnr.[Position_Date], prtnr.[FP_End])/365.2425), 2) as 'TimeInPosition'&#xA;	  ,org.[StoreAbbrev] as STORE_NUM&#xA;	  --,org.[StoreName]&#xA;      --,org.[DistrictOrgid]&#xA;      --,org.[DistrictAbbrev]&#xA;      --,org.[DistrictName]&#xA;      --,org.[AreaOrgid]&#xA;      --,org.[AreaAbbrev]&#xA;      --,org.[AreaName]&#xA;      --,org.[RegionOrgid]&#xA;      --,org.[RegionAbbrev]&#xA;      --,org.[RegionName]&#xA;      --,org.[DivisionOrgid]&#xA;      --,org.[DivisionAbbrev]&#xA;      --,org.[DivisionName]&#xA;  FROM [PDW_Bulk].[hpohlman].[PRO_BaseData] prtnr&#xA;&#xA;   LEFT JOIN [PDW_Bulk].[PRODW].[ORG_TREE_DRAD] org&#xA;		on prtnr.Org_Unit = org.StoreOrgid&#xA;	WHERE prtnr.Country = 'US' AND prtnr.Status = 'Active'&#xA;		 AND prtnr.FY = 2018 and prtnr.FP = 4&#xA;		AND prtnr.Action_Group = 'Headcount'&#xA;		AND prtnr.Org_Segment = 'FMH'&#xA;		--AND prtnr.Job_Number IN (50000362, 50000358, 50000445, 50018175, 50000118, 50000117) /* 50000117 is store manager */&#xA;		AND prtnr.Job_Number IN (50000117) /* 50000117 is store manager */" type="V_WString" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="33">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="1638" y="162" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_5d8b3bacde1f484c8731b601c6daf142_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="34">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1518" y="66" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>SM Tenure in Store</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="35">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1518" y="114" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Pulls SM tenure in store, current.</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="40">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="1734" y="174" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)

SELECT prtnr.store_num
    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.
    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. 
    , cal.FSCL_YR_NUM
    , cal.FSCL_PER_IN_YR_NUM
    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT
    --, str.DIST_NUM
    --, str.AREA_NUM
    --, str.RGN_NUM
    --, str.ZONE_NUM
    --, str.LAT_NUM
    --, str.LONG_NUM

FROM TURNOVER_PRTNR_V prtnr

  LEFT JOIN ADV_CAL cal
      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. 
        -- However you want to slice/aggregate by time, they exist in this table
      
  LEFT JOIN ADV_STORE str
    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. 
        -- However you want to slice/aggregate by DRAD, they exist in this table

WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND
    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period
    cal.FSCL_YR_NUM = 2018 AND -- add or change year
    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP
    str.CNTRY_CD = 'US' AND  -- US only? Canada?
    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?
    str.STORE_ASCD_CD = 'ACTIVE' -- store open. 
    AND prtnr.JOB_ID IN ('50000362','50000358')

GROUP BY prtnr.FSCL_PER_SID
    , prtnr.store_num
    , cal.FSCL_YR_NUM
    , cal.FSCL_PER_IN_YR_NUM
    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT
    --, str.DIST_NUM
    --, str.AREA_NUM
    --, str.RGN_NUM
    --, str.ZONE_NUM
    --, str.LAT_NUM
    --, str.LONG_NUM
    
ORDER BY prtnr.FSCL_PER_SID
    , prtnr.store_num
    , cal.FSCL_YR_NUM
    , cal.FSCL_PER_IN_YR_NUM
    --, str.DIST_NUM
    --, str.AREA_NUM
    --, str.RGN_NUM
    --, str.ZONE_NUM
    --, str.LAT_NUM
    --, str.LONG_NUM</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP415.WORLD
Table=--SBP415 (PDW)

SELECT prtnr.store_num
    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.
    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. 
    , cal.FSCL_YR_NUM
    , cal.FSCL_PER_IN_YR_NUM
    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT
    --, str.DIST_NUM
    --, str.AREA_NUM
    --, str.RGN_NUM
    --, str.ZONE_NUM
    --, str.LAT_NUM
    --, str.LONG_NUM

FROM TURNOVER_PRTNR_V prtnr

  LEFT JOIN ADV_CAL cal
      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. 
        -- However you want to slice/aggregate by time, they exist in this table
      
  LEFT JOIN ADV_STORE str
    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. 
        -- However you want to slice/aggregate by DRAD, they exist in this table

WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND
    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period
    cal.FSCL_YR_NUM = 2018 AND -- add or change year
    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP
    str.CNTRY_CD = 'US' AND  -- US only? Canada?
    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?
    str.STORE_ASCD_CD = 'ACTIVE' -- store open. 
    AND prtnr.JOB_ID IN ('50000362','50000358')

GROUP BY prtnr.FSCL_PER_SID
    , prtnr.store_num
    , cal.FSCL_YR_NUM
    , cal.FSCL_PER_IN_YR_NUM
    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT
    --, str.DIST_NUM
    --, str.AREA_NUM
    --, str.RGN_NUM
    --, str.ZONE_NUM
    --, str.LAT_NUM
    --, str.LONG_NUM
    
ORDER BY prtnr.FSCL_PER_SID
    , prtnr.store_num
    , cal.FSCL_YR_NUM
    , cal.FSCL_PER_IN_YR_NUM
    --, str.DIST_NUM
    --, str.AREA_NUM
    --, str.RGN_NUM
    --, str.ZONE_NUM
    --, str.LAT_NUM
    --, str.LONG_NUM</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)&#xA;&#xA;SELECT prtnr.store_num&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. &#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;&#xA;FROM TURNOVER_PRTNR_V prtnr&#xA;&#xA;  LEFT JOIN ADV_CAL cal&#xA;      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. &#xA;        -- However you want to slice/aggregate by time, they exist in this table&#xA;      &#xA;  LEFT JOIN ADV_STORE str&#xA;    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. &#xA;        -- However you want to slice/aggregate by DRAD, they exist in this table&#xA;&#xA;WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND&#xA;    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period&#xA;    cal.FSCL_YR_NUM = 2018 AND -- add or change year&#xA;    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP&#xA;    str.CNTRY_CD = 'US' AND  -- US only? Canada?&#xA;    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?&#xA;    str.STORE_ASCD_CD = 'ACTIVE' -- store open. &#xA;    AND prtnr.JOB_ID IN ('50000362','50000358')&#xA;&#xA;GROUP BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;    &#xA;ORDER BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM" type="Double" />
            <Field name="HEADCOUNT" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)&#xA;&#xA;SELECT prtnr.store_num&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. &#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;&#xA;FROM TURNOVER_PRTNR_V prtnr&#xA;&#xA;  LEFT JOIN ADV_CAL cal&#xA;      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. &#xA;        -- However you want to slice/aggregate by time, they exist in this table&#xA;      &#xA;  LEFT JOIN ADV_STORE str&#xA;    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. &#xA;        -- However you want to slice/aggregate by DRAD, they exist in this table&#xA;&#xA;WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND&#xA;    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period&#xA;    cal.FSCL_YR_NUM = 2018 AND -- add or change year&#xA;    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP&#xA;    str.CNTRY_CD = 'US' AND  -- US only? Canada?&#xA;    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?&#xA;    str.STORE_ASCD_CD = 'ACTIVE' -- store open. &#xA;    AND prtnr.JOB_ID IN ('50000362','50000358')&#xA;&#xA;GROUP BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;    &#xA;ORDER BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM" type="Double" />
            <Field name="SEPCOUNT" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)&#xA;&#xA;SELECT prtnr.store_num&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. &#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;&#xA;FROM TURNOVER_PRTNR_V prtnr&#xA;&#xA;  LEFT JOIN ADV_CAL cal&#xA;      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. &#xA;        -- However you want to slice/aggregate by time, they exist in this table&#xA;      &#xA;  LEFT JOIN ADV_STORE str&#xA;    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. &#xA;        -- However you want to slice/aggregate by DRAD, they exist in this table&#xA;&#xA;WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND&#xA;    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period&#xA;    cal.FSCL_YR_NUM = 2018 AND -- add or change year&#xA;    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP&#xA;    str.CNTRY_CD = 'US' AND  -- US only? Canada?&#xA;    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?&#xA;    str.STORE_ASCD_CD = 'ACTIVE' -- store open. &#xA;    AND prtnr.JOB_ID IN ('50000362','50000358')&#xA;&#xA;GROUP BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;    &#xA;ORDER BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM" type="Double" />
            <Field name="FSCL_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)&#xA;&#xA;SELECT prtnr.store_num&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. &#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;&#xA;FROM TURNOVER_PRTNR_V prtnr&#xA;&#xA;  LEFT JOIN ADV_CAL cal&#xA;      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. &#xA;        -- However you want to slice/aggregate by time, they exist in this table&#xA;      &#xA;  LEFT JOIN ADV_STORE str&#xA;    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. &#xA;        -- However you want to slice/aggregate by DRAD, they exist in this table&#xA;&#xA;WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND&#xA;    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period&#xA;    cal.FSCL_YR_NUM = 2018 AND -- add or change year&#xA;    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP&#xA;    str.CNTRY_CD = 'US' AND  -- US only? Canada?&#xA;    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?&#xA;    str.STORE_ASCD_CD = 'ACTIVE' -- store open. &#xA;    AND prtnr.JOB_ID IN ('50000362','50000358')&#xA;&#xA;GROUP BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;    &#xA;ORDER BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM" type="Double" />
            <Field name="FSCL_PER_IN_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)&#xA;&#xA;SELECT prtnr.store_num&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. &#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;&#xA;FROM TURNOVER_PRTNR_V prtnr&#xA;&#xA;  LEFT JOIN ADV_CAL cal&#xA;      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. &#xA;        -- However you want to slice/aggregate by time, they exist in this table&#xA;      &#xA;  LEFT JOIN ADV_STORE str&#xA;    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. &#xA;        -- However you want to slice/aggregate by DRAD, they exist in this table&#xA;&#xA;WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND&#xA;    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period&#xA;    cal.FSCL_YR_NUM = 2018 AND -- add or change year&#xA;    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP&#xA;    str.CNTRY_CD = 'US' AND  -- US only? Canada?&#xA;    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?&#xA;    str.STORE_ASCD_CD = 'ACTIVE' -- store open. &#xA;    AND prtnr.JOB_ID IN ('50000362','50000358')&#xA;&#xA;GROUP BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;    &#xA;ORDER BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM" type="Double" />
            <Field name="STORE_OPEN_DAYS_IN_WK_CNT" source="File: oci:JUMORRIS/__EncPwd1__@SBP415.WORLD|||--SBP415 (PDW)&#xA;&#xA;SELECT prtnr.store_num&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.INCLUDE_IN_HDCNT_FLG = 'Y' THEN prtnr.PRTNR_ID END) as Headcount -- count only one headcount per month for non-termed partners.&#xA;    , COUNT(DISTINCT CASE WHEN prtnr.EMP_STAT_CD = 'Withdrawn' THEN prtnr.PRTNR_ID END) as SepCount -- count terms in that FP. &#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;&#xA;FROM TURNOVER_PRTNR_V prtnr&#xA;&#xA;  LEFT JOIN ADV_CAL cal&#xA;      on prtnr.FSCL_PER_SID = cal.FSCL_PER_SID -- here be time monstyrs. &#xA;        -- However you want to slice/aggregate by time, they exist in this table&#xA;      &#xA;  LEFT JOIN ADV_STORE str&#xA;    on prtnr.STORE_NUM = str.STORE_NUM -- DRAD and store type/characteristics. &#xA;        -- However you want to slice/aggregate by DRAD, they exist in this table&#xA;&#xA;WHERE cal.FSCL_PER_END_DT = cal.FSCL_WK_END_DT AND&#xA;    cal.FSCL_PER_IN_YR_NUM IN (4) AND  -- add or change fiscal period&#xA;    cal.FSCL_YR_NUM = 2018 AND -- add or change year&#xA;    str.SNAPSHOT_DT = '01-JAN-18' AND -- limit store snapshot to the FP start date after your last included FP&#xA;    str.CNTRY_CD = 'US' AND  -- US only? Canada?&#xA;    str.OWNR_TYPE_CD = 'CO' AND  -- company owned? ls?&#xA;    str.STORE_ASCD_CD = 'ACTIVE' -- store open. &#xA;    AND prtnr.JOB_ID IN ('50000362','50000358')&#xA;&#xA;GROUP BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    , prtnr.STORE_OPEN_DAYS_IN_WK_CNT&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM&#xA;    &#xA;ORDER BY prtnr.FSCL_PER_SID&#xA;    , prtnr.store_num&#xA;    , cal.FSCL_YR_NUM&#xA;    , cal.FSCL_PER_IN_YR_NUM&#xA;    --, str.DIST_NUM&#xA;    --, str.AREA_NUM&#xA;    --, str.RGN_NUM&#xA;    --, str.ZONE_NUM&#xA;    --, str.LAT_NUM&#xA;    --, str.LONG_NUM" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="41">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="1854" y="174" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_5cc88dcc78a5495dbaef6310ab1f2dbc_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="42">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1734" y="54" width="100" height="64" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text><![CDATA[Hourly partner turnover - PDW
]]></Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="43">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1734" y="126" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>Calculates turnover rate for non-SMs/ASMs at the store-level.</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="44">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="450" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ 

SELECT DISTINCT
  sr.STORE_NUM
  ,sr.QSTN_ID
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tt.ORD_MTHD_CD
  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */
    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB
  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS
  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE
  
FROM APPOTHER.AFT_CV_SRVY_RSPNS sr

JOIN APPCA.D_CAL ca
  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)
  
JOIN APPCA.D_STORE_VERS st
  ON sr.STORE_NUM = st.STORE_NUM
    AND st.CURRENT_FLG = 'Y'
    AND st.OWNR_TYPE_CD = 'CO'

LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w
  ON sr.CASE_ID = w.CASE_ID

/* Create universal transaction ID from survey table and use that to join to POS table
/  Limit to U.S. and Canada and transactions after the survey began to improve performance */
JOIN APPCA.F_POS_LINE_ITEM pi
  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))
      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID
    AND pi.CNTRY_CD = 'US'
    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'
  
JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt
  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY
  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')
  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')
  AND sr.QSTN_ID IN ('Q2_1') -- SPEED
  AND sr.RSPNS_ID &lt;&gt; '9'
  AND ca.FSCL_YR_NUM = 2018 
  AND ca.FSCL_QTR_IN_YR_NUM = 1
      
GROUP BY
  sr.STORE_NUM
  ,sr.QSTN_ID
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tt.ORD_MTHD_CD
ORDER BY
  sr.STORE_NUM
  ,sr.QSTN_ID
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tt.ORD_MTHD_CD</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=/* CE by channel -- CAW */ 

SELECT DISTINCT
  sr.STORE_NUM
  ,sr.QSTN_ID
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tt.ORD_MTHD_CD
  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */
    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB
  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS
  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE
  
FROM APPOTHER.AFT_CV_SRVY_RSPNS sr

JOIN APPCA.D_CAL ca
  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)
  
JOIN APPCA.D_STORE_VERS st
  ON sr.STORE_NUM = st.STORE_NUM
    AND st.CURRENT_FLG = 'Y'
    AND st.OWNR_TYPE_CD = 'CO'

LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w
  ON sr.CASE_ID = w.CASE_ID

/* Create universal transaction ID from survey table and use that to join to POS table
/  Limit to U.S. and Canada and transactions after the survey began to improve performance */
JOIN APPCA.F_POS_LINE_ITEM pi
  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))
      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID
    AND pi.CNTRY_CD = 'US'
    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'
  
JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt
  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY
  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')
  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')
  AND sr.QSTN_ID IN ('Q2_1') -- SPEED
  AND sr.RSPNS_ID &lt;&gt; '9'
  AND ca.FSCL_YR_NUM = 2018 
  AND ca.FSCL_QTR_IN_YR_NUM = 1
      
GROUP BY
  sr.STORE_NUM
  ,sr.QSTN_ID
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tt.ORD_MTHD_CD
ORDER BY
  sr.STORE_NUM
  ,sr.QSTN_ID
  ,ca.FSCL_YR_NUM
  ,ca.FSCL_QTR_IN_YR_NUM
  ,tt.ORD_MTHD_CD</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" size="11" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="WString" />
            <Field name="QSTN_ID" size="51" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="V_WString" />
            <Field name="FSCL_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="Double" />
            <Field name="FSCL_QTR_IN_YR_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="Double" />
            <Field name="ORD_MTHD_CD" size="11" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="WString" />
            <Field name="TOTAL_TB" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="Double" />
            <Field name="TOTAL_RSPNS" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="Double" />
            <Field name="TB_SCORE" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||/* CE by channel -- CAW */ &#xA;&#xA;SELECT DISTINCT&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;  ,SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) /* coalesce returns non-null weight value, OR if null, returns 1 */&#xA;    WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END) AS TOTAL_TB&#xA;  ,SUM(COALESCE(w.WEIGHT_RT,1)) AS TOTAL_RSPNS&#xA;  ,ROUND((SUM(CASE  WHEN sr.RSPNS_ID = '5' AND sr.QSTN_ID = 'Q1' THEN COALESCE(w.WEIGHT_RT,1) WHEN sr.RSPNS_ID = '7' THEN COALESCE(w.WEIGHT_RT,1) ELSE 0 END)) / SUM(COALESCE(w.WEIGHT_RT,1)),4) AS TB_SCORE&#xA;  &#xA;FROM APPOTHER.AFT_CV_SRVY_RSPNS sr&#xA;&#xA;JOIN APPCA.D_CAL ca&#xA;  ON ca.CAL_DT = TRUNC(sr.TRANS_DTM)&#xA;  &#xA;JOIN APPCA.D_STORE_VERS st&#xA;  ON sr.STORE_NUM = st.STORE_NUM&#xA;    AND st.CURRENT_FLG = 'Y'&#xA;    AND st.OWNR_TYPE_CD = 'CO'&#xA;&#xA;LEFT JOIN APPOTHER.CUST_INS_WEIGHTS w&#xA;  ON sr.CASE_ID = w.CASE_ID&#xA;&#xA;/* Create universal transaction ID from survey table and use that to join to POS table&#xA;/  Limit to U.S. and Canada and transactions after the survey began to improve performance */&#xA;JOIN APPCA.F_POS_LINE_ITEM pi&#xA;  ON TO_CHAR(sr.TRANS_DTM, 'YYYYMMDD') || TRIM(TO_CHAR(sr.STORE_NUM, '000000'))&#xA;      || TRIM(TO_CHAR(SUBSTR(sr.RGSTR_NUM, -1, 2),'00')) || sr.TRANS_ID = pi.TRANS_ID&#xA;    AND pi.CNTRY_CD = 'US'&#xA;    --AND pi.BUS_DT &gt;= '01-OCT-17' AND pi.BUS_DT &lt; '01-DEC-17'&#xA;  &#xA;JOIN APPCA.D_POS_LINE_ITEM_TRANS_TYPE tt&#xA;  ON pi.POS_LINE_ITEM_TRANS_TYPE_KEY = tt.POS_LINE_ITEM_TRANS_TYPE_KEY&#xA;  WHERE tt.ORD_MTHD_CD IN ('CAFE','MOP','OTW')&#xA;  --AND sr.QSTN_ID IN ('Q1', 'Q2_1','Q2_2','Q2_3','Q2_4','Q2_5','Q2_6','Q2_7','Q2_8')&#xA;  AND sr.QSTN_ID IN ('Q2_1') -- SPEED&#xA;  AND sr.RSPNS_ID &lt;&gt; '9'&#xA;  AND ca.FSCL_YR_NUM = 2018 &#xA;  AND ca.FSCL_QTR_IN_YR_NUM = 1&#xA;      &#xA;GROUP BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD&#xA;ORDER BY&#xA;  sr.STORE_NUM&#xA;  ,sr.QSTN_ID&#xA;  ,ca.FSCL_YR_NUM&#xA;  ,ca.FSCL_QTR_IN_YR_NUM&#xA;  ,tt.ORD_MTHD_CD" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="45">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="570" y="150" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_ae0a604e1ba14d19984903a3d1f4f9d6_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="46">
      <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
        <Position x="1926" y="174" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Passwords>498212DC0C96BB024DC50B75B7220C9B5ED03B6C6DE73</Passwords>
          <File RecordLimit="" FileFormat="17">oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */

select STORE_NUM, DRIVE_THRU_IND from APPCA.D_STORE_VERS ss
where CURRENT_FLG = 'Y'
and CNTRY_CD_2_DGT_ISO = 'US'
  AND OWNR_TYPE_CD = 'CO'</File>
          <FormatSpecificOptions>
            <ForceSqlWcharSupport>False</ForceSqlWcharSupport>
            <ReadCentroids>False</ReadCentroids>
            <TableStyle>Quoted</TableStyle>
            <NoProgress>False</NoProgress>
            <CacheData>False</CacheData>
            <PostSQL />
            <PreSQL />
          </FormatSpecificOptions>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText>Database: @SBP416.world
Table=--/* CAW */

select STORE_NUM, DRIVE_THRU_IND from APPCA.D_STORE_VERS ss
where CURRENT_FLG = 'Y'
and CNTRY_CD_2_DGT_ISO = 'US'
  AND OWNR_TYPE_CD = 'CO'</DefaultAnnotationText>
          <Left value="False" />
        </Annotation>
        <MetaInfo connection="Output">
          <RecordInfo>
            <Field name="STORE_NUM" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;select STORE_NUM, DRIVE_THRU_IND from APPCA.D_STORE_VERS ss&#xA;where CURRENT_FLG = 'Y'&#xA;and CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND OWNR_TYPE_CD = 'CO'" type="Double" />
            <Field name="DRIVE_THRU_IND" source="File: oci:JUMORRIS/__EncPwd1__@SBP416.world|||--/* CAW */&#xA;&#xA;select STORE_NUM, DRIVE_THRU_IND from APPCA.D_STORE_VERS ss&#xA;where CURRENT_FLG = 'Y'&#xA;and CNTRY_CD_2_DGT_ISO = 'US'&#xA;  AND OWNR_TYPE_CD = 'CO'" type="Double" />
          </RecordInfo>
        </MetaInfo>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
    </Node>
    <Node ToolID="47">
      <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
        <Position x="2046" y="174" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <TempFile>C:\Users\jumorris\AppData\Local\Temp\Engine_17132_da134f87c19247389a5846872d1ae68e_\Engine_10728_ef5e7eb6992a4b5a98fdd48da92f6f16_.yxdb</TempFile>
          <TempFileDataProfiling />
          <Layout>
            <ViewMode>Single</ViewMode>
            <ViewSize value="100" />
            <View1>
              <DefaultTab>Profile</DefaultTab>
              <Hints>
                <Table />
              </Hints>
            </View1>
            <View2 />
          </Layout>
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
    </Node>
    <Node ToolID="48">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1926" y="66" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>DT Flag</Text>
          <Font name="Segoe UI" size="8.25" style="1" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="2" />
          <Justification Justification="1" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="49">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="1926" y="126" width="100" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>DT flag at the store level</Text>
          <Font name="Segoe UI" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
  </Nodes>
  <Connections>
    <Connection>
      <Origin ToolID="1" Connection="Output" />
      <Destination ToolID="2" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="5" Connection="Output" />
      <Destination ToolID="6" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="16" Connection="Output" />
      <Destination ToolID="17" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="20" Connection="Output" />
      <Destination ToolID="21" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="24" Connection="Output" />
      <Destination ToolID="25" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="28" Connection="Output" />
      <Destination ToolID="29" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="32" Connection="Output" />
      <Destination ToolID="33" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="40" Connection="Output" />
      <Destination ToolID="41" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="44" Connection="Output" />
      <Destination ToolID="45" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="46" Connection="Output" />
      <Destination ToolID="47" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="True" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>2018-04-04_USCO_Earnings</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
    </MetaInfo>
    <Events>
      <Enabled value="True" />
    </Events>
  </Properties>
</AlteryxDocument>